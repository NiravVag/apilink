
@{
    ViewData["Title"] = "ExtraFeeSearchSummary";
    int? oldExtraFeeId = 0;
}

@model IEnumerable<DTO.ExtraFees.ExtraFeeSummaryExportItem>

<xls-sheet name="Extra Fee Search Summary">
    <table xls-begin="A:1" style="border-style:solid">
        <tr style="background-color:#f5f5f5;font-weight:bold;text-align:center">
            <th>BookingId</th>
            <th>CustomerBookingNo</th>
            <th>BilledTo</th>
            <th>Customer Name</th>
            <th>Supplier Name</th>
            <th>Ex. Fee Type</th>
            <th>Ex. Fee</th>
            <th>Exchange Rate</th>
            <th>Invoice Currency</th>
            <th>Total Amt</th>
            <th>Ex. Fee Comment</th>
            <th>Currency</th>
            <th>Service</th>
            <th>InvoiceNumber</th>
            <th>Extra Fee Invoice Number</th>
            <th>Status</th>
            <th>Remarks</th>
            <th>Ex. Invoice Date</th>
            <th>Ex. Payment Date</th>
            <th>Ex. Payment Status</th>

        </tr>
        @foreach (var item in Model)
        {
    <tr>
        <td width="150px">@Html.Raw(@item.BookingId)</td>
        <td width="150px">@Html.Raw(@item.CustomerBookingNo)</td>
        <td width="150px">@Html.Raw(@item.BilledTo)</td>
        <td width="150px">@Html.Raw(@item.CustomerName)</td>
        <td width="150px">@Html.Raw(@item.SupplierName)</td>
        <td width="150px">@Html.Raw(@item.ExFeeType)</td>
        <td width="150px" xls-type="number">@Html.Raw(@item.ExtraTypefee)</td>
        <td width="150px" xls-type="number">@Html.Raw(@item.ExchangeRate)</td>
        <td width="150px">@item.InvoiceCurrency</td>
        @if (oldExtraFeeId != item.ExtraFeeId)
        {
            <td width="150px" xls-type="number">@Html.Raw(@item.TotalAmt)</td>
        }
        else
        {
            <td width="150px" xls-type="number"></td>
        }
        <td width="150px">@Html.Raw(@item.ExtraTypeRemarks)</td>
        <td width="150px">@Html.Raw(@item.Currency)</td>
        <td width="150px">@Html.Raw(@item.Service)</td>
        <td width="150px">@Html.Raw(@item.InvoiceNumber)</td>
        <td width="150px">@Html.Raw(@item.ExtraFeeInvoiceNumber)</td>
        <td width="150px">@Html.Raw(@item.StatusName)</td>
        <td width="150px">@item.Remarks</td>
        <td width="150px">@item.InvoiceDate</td>
        <td width="150px">@item.PaymentDate</td>
        <td width="150px">@item.PaymentStatus</td>

        @{
            oldExtraFeeId = item.ExtraFeeId;
        }
    </tr>

        }
    </table>
</xls-sheet>
