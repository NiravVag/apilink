<div class="main-wrapper">
  <!-- <app-header [commonHeader]="true"></app-header> -->
  <div class="wrapper dashboard-wrapper booking-flow-placeholder-container" *ngIf="!bookingMasterData.issuccess">

    <!-- #region Title Container-->
    <div class="page-head-container no-shadow">
      <div class="my-container">

        <!-- #region Header Back Button-->
        <div class="header-back-button" *ngIf="(!bookingMasterData.Initialloading)
                   && (bookingMasterData.isFromSplitBooking) || (fromSummary)">
          <img src="assets/images/back-red.png" alt="back" (click)="returnToPreviouspage()">
        </div>
        <!-- #endregion Header Back Button-->

        <div class="column single-child-mobile">


          <!-- #region Inspection Header(Inspection Id with status)-->
          <h2 class="page-title" style="float:left;">
            {{'EDIT_BOOKING.TITLE' | translate }}
            <span class="highlight-badge"
              *ngIf="model.id!=null && model.id!=0 && !isReInspection && !isReBooking">#{{model.id}}</span>
            <span class="highlight-badge in-progress" *ngIf="model.id!=null && model.id!=0 &&
                          !isReInspection && !isReBooking">({{model.statusName}})</span>
            <span *ngIf="model.id>0 && model.isEaqf" style="color:red">{{'EDIT_BOOKING.LBL_EAQF' | translate }}</span>
          </h2>
          <!-- #endregion Inspection Header(Inspection Id with status)-->

        </div>

      </div>

    </div>
    <!-- #endregion Title Container-->

    <div class="my-container" *ngIf="!isPreviewPanelVisible && draftBookingList && draftBookingList.length>0">

      <!--#region Tab Container(Draft,New Booking)-->
      <div class="horizontal-tab-container dark">
        <ul>
          <li (click)="changeView(_bookingViewTypeEnum.DraftBooking)"
            [ngClass]="{'active': viewType == _bookingViewTypeEnum.DraftBooking}">
            {{
            'EDIT_BOOKING.LBL_DRAFT_BOOKING' |
            translate
            }}
          </li>
          <li (click)="changeView(_bookingViewTypeEnum.NewBooking)"
            [ngClass]="{'active': viewType == _bookingViewTypeEnum.NewBooking}">
            {{
            'EDIT_BOOKING.LBL_NEW_BOOKING' |
            translate
            }}
          </li>
        </ul>
      </div>
      <!--#endregion Tab Container(Draft,New Booking)-->
      <!--#region Draft Tab Container-->
      <ng-container *ngIf="viewType == _bookingViewTypeEnum.DraftBooking">
        <div class="ml-1 pl-2 mr-1 pr-2">

          <div class="record-count pl-0 pr-0 align-items-end">
            <div class="column d-flex align-items-xl-center flex-sm-column flex-xl-row inspection-table-badge-wrapper">
            </div>
            <div class="column"></div>
          </div>

          <div class="table-container">

            <table class="pagination-table">
              <thead>
                <tr>

                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_CUSTOMER' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_SUPPLIER' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_FACTORY' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_SERVICE_DATE' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_BRAND' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_DEPARTMENT' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_PREV_BOOKING_NO' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_DRAFT_INSP_CREATED_ON' | translate }}</th>
                  <th></th>

                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of draftBookingList;let idx = index">

                  <td class="width-120 wordbreak"> {{item.customer}}</td>
                  <td class="width-120 wordbreak">{{item.supplier}}</td>
                  <td class="width-120 wordbreak">{{item.factory}}</td>

                  <td>
                    {{item.serviceDate}}
                  </td>

                  <!-- <td class="width-100">{{item.serviceDateFrom}}</td> -->
                  <td class="width-120 wordbreak">{{item.brand}}</td>
                  <td class="width-120 wordbreak">{{item.department}}</td>
                  <td class="width-120 wordbreak">
                    <span *ngIf="item.isReInspectionDraft">
                      {{item.previousBookingNo}}
                    </span>
                  </td>
                  <td class="width-120 wordbreak">{{item.createdOn}}</td>

                  <td>
                    <button class="secondary-cta small mr-2" [disabled]="item.id==draftInspectionId"
                      (click)="cancelDraftBooking(deleteDraftInspection,item)">
                      {{
                      'EDIT_BOOKING.LBL_DRAFT_CANCEL' |
                      translate
                      }}
                    </button>
                    <button class="primary-cta small" [disabled]="item.id==draftInspectionId"
                      (click)="resumeBooking(item)">
                      {{ 'EDIT_BOOKING.LBL_DRAFT_RESUME' | translate }}
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>

          </div>
        </div>
      </ng-container>
      <!--#endregion Draft Tab Container-->
      <!--#region Booking Tab Container-->
      <ng-container *ngIf="viewType == _bookingViewTypeEnum.NewBooking">
        <ng-template [ngTemplateOutlet]="bookingTemplate">
        </ng-template>
      </ng-container>
      <!--#endregion Booking Tab Container-->

    </div>

    <div class="my-container" *ngIf="!isPreviewPanelVisible && (!draftBookingList || draftBookingList.length==0)">

      <ng-template [ngTemplateOutlet]="bookingTemplate">
      </ng-template>

    </div>




    <!--#region PreviewContainer-->
    <div class="my-container">
      <div class="audit-confirmation-container" *ngIf="isPreviewPanelVisible">
        <div class="row">
          <div class="col-sm-12">
            <div class="confirmation-title-container">
              <img src="assets/images/audit-step-2.svg" alt="">
              <h4 class="title"> {{ 'EDIT_BOOKING.LBL_GENERALINFORMATION' | translate }}</h4>
              <button class="secondary-cta x-small" (click)="openPanelFromPreview(panelData.Step1)">
                {{ 'EDIT_BOOKING.LBL_EDIT' | translate}}
              </button>
            </div>
          </div>
        </div>


        <div class="row audit-data-container">
          <div class="col-sm-6 col-md-6 col-lg-8">
            <div class="row">
              <div class="col-sm-12 col-md-12 col-lg-5 border-right">
                <div class="my-input-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_CUS' | translate }}</label>
                  <p class="input-value">
                    <strong class="wordbreak">{{bookingPreviewData.cusname}}</strong><br>
                  </p>
                </div>
                <div class="my-input-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_CUSTOMERCONTACT' | translate }}</label>
                  <p class="input-value" *ngFor="let item of bookingPreviewData.customerContact">
                    <strong class="wordbreak">{{item.name}}{{item.email}}</strong><br>
                  </p>
                </div>

                <div class="my-input-group inline-group">
                  <label for="" *ngIf="bookingPreviewData.brand!=''">
                    {{
                    'EDIT_BOOKING.LBL_CUS_BRAND' | translate
                    }}
                  </label>
                  <p class="input-value wordbreak"><strong>{{bookingPreviewData.brand}}</strong></p>
                  <label for="" *ngIf="bookingPreviewData.department!=''">
                    {{
                    'EDIT_BOOKING.LBL_CUS_DEPARTMENT' |
                    translate
                    }}
                  </label>
                  <p class="input-value wordbreak"><strong>{{bookingPreviewData.department}}</strong></p>
                  <!--  <label for="" *ngIf="isReInspection">Previous Booking No</label> -->
                  <label for="" *ngIf="bookingPreviewData.buyer!=''">
                    {{
                    'EDIT_BOOKING.LBL_BUYER' | translate
                    }}
                  </label>
                  <p class="input-value wordbreak"><strong>{{bookingPreviewData.buyer}}</strong></p>
                  <label for="" *ngIf="bookingPreviewData.merchandiser!=''">
                    {{
                    'EDIT_BOOKING.LBL_CUS_MERCHANDISER' |
                    translate
                    }}
                  </label>
                  <p class="input-value wordbreak"><strong>{{bookingPreviewData.merchandiser}}</strong></p>
                  <label for="" *ngIf="bookingPreviewData.customerBookingNumber!=''">
                    {{
                    'EDIT_BOOKING.LBL_CUS_BOOKING_NO' | translate
                    }}
                  </label>
                  <p class="input-value wordbreak"><strong>{{bookingPreviewData.customerBookingNumber}}</strong></p>
                </div>


              </div>
              <div class="col-sm-12 col-md-12 col-lg-7 padding-left border-right">
                <div class="my-input-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_FACT' | translate }}</label>
                  <p class="input-value">
                    <strong class="wordbreak">{{bookingPreviewData.factoryname}}</strong>
                  </p>
                </div>
                <div class="my-input-group wordbreak"
                  *ngIf="bookingPreviewData.factoryRegionName!=null && bookingPreviewData.factoryRegionName!=bookingPreviewData.factoryname">
                  <label for="">{{bookingPreviewData.factoryRegionName}}</label>
                </div>
                <div class="my-input-group wordbreak">
                  <label for="">{{bookingPreviewData.factaddress}}</label>
                </div>
                <div class="my-input-group wordbreak">
                  <label for="">{{bookingPreviewData.factRegaddress}}</label>
                </div>
                <div class="my-input-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_FACTORYCONTACT' | translate }}</label>
                  <p class="input-value" *ngFor="let item of bookingPreviewData.factoryContact">
                    <strong class="wordbreak">{{item.name}}{{item.email}}</strong><br>
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-md-6 col-lg-4 padding-left tablet-padding-left last-column last-preview">
            <div class="my-input-group">
              <label for="">{{ 'EDIT_BOOKING.LBL_SUP' | translate }}</label>
              <p class="input-value">
                <strong class="wordbreak">{{bookingPreviewData.suppliername}}</strong><br>
              </p>
            </div>
            <div class="my-input-group wordbreak"
              *ngIf="bookingPreviewData.supplierRegionName!=null && bookingPreviewData.supplierRegionName!=bookingPreviewData.suppliername">
              <label for="">{{bookingPreviewData.supplierRegionName}}</label>
            </div>
            <div class="my-input-group">
              <label for="">{{ 'EDIT_BOOKING.LBL_SUPPLIERCONTACT' | translate }}</label>
              <p class="input-value" *ngFor="let item of bookingPreviewData.supplierContact">
                <strong class="wordbreak">{{item.name}}{{item.email}}</strong><br>
              </p>
            </div>

            <div class="my-input-group" *ngIf="bookingPreviewData.previousBookingNo">
              <label for="">{{ 'EDIT_BOOKING.LBL_PREVBOOKINGNO' | translate }}</label>
              <p class="input-value">
                <span *ngFor="let prevNo of bookingPreviewData.previousBookingNoList; let isLast=last">
                  <a triggers="mouseenter:mouseleave" style="display: inline;">
                    <span (click)="RedirectToEdit(prevNo)" style="color: blue;"
                      class="input-value wordbreak">#{{prevNo}}</span>
                  </a>{{
                  isLast ? '' : ',
                  '
                  }}
                </span>
              </p>
            </div>

          </div>

        </div>

        <div class="row marginTop25 mobile-margin-top-15">
          <div class="col-sm-12">
            <div class="confirmation-title-container">
              <img src="assets/images/audit-step-3.svg" alt="">
              <h4 class="title">{{ 'EDIT_BOOKING.LBL_PROCESSINFORMATION' | translate }}</h4>
              <button class="secondary-cta x-small" (click)="openPanelFromPreview(panelData.Step2)">
                {{ 'EDIT_BOOKING.LBL_EDIT' | translate}}
              </button>
            </div>
          </div>
        </div>

        <div class="row audit-data-container">
          <div class="col-sm-6 col-md-6 col-lg-8">
            <div class="row">
              <div class="col-sm-12 col-md-12 col-lg-5 border-right">
                <div class="my-input-group inline-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_CUS_SERVICETYPE' | translate }}</label>
                  <p class="input-value"><strong>{{bookingPreviewData.servicetype}}</strong></p>
                </div>
                <div class="my-input-group inline-group">
                  <label for="">
                    {{ 'EDIT_BOOKING.LBL_TOTAL_BOOKINGQTY' | translate }}
                    {{ 'EDIT_BOOKING.LBL_TOTAL_QTY' | translate }}
                  </label>
                  <p class="input-value"><strong>{{bookingMasterData.totalBookingQty}}</strong></p>
                </div>
                <div *ngIf="bookingMasterData.IsInternalUser" class="my-input-group inline-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_Service_FIRST_FROMDATE' | translate }}</label>
                  <p class="input-value"><strong>{{bookingPreviewData.firstServicefromdatepanel}}</strong></p>
                </div>
                <div *ngIf="bookingMasterData.IsInternalUser" class="my-input-group inline-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_Service_FIRST_TODATE' | translate }}</label>
                  <p class="input-value"><strong>{{bookingPreviewData.firstServicetodatepanel}}</strong></p>
                </div>
                <!-- <div class="my-input-group inline-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_REPORTS' | translate }}</label>
                  <p class="input-value"><strong>{{bookingMasterData.totalReports}}</strong></p>
                </div> -->
              </div>
              <div class="col-sm-12 col-md-12 col-lg-7 padding-left border-right">
                <div class="my-input-group inline-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_SERVICE_FROMDATE' | translate }}</label>
                  <p class="input-value"><strong>{{bookingPreviewData.servicefromdatepanel}}</strong></p>
                </div>
                <div class="my-input-group inline-group" *ngIf="!isContainerService">
                  <label for="">
                    {{ 'EDIT_BOOKING.LBL_TOTAL_PICKINGQTY' | translate }}
                    {{ 'EDIT_BOOKING.LBL_TOTAL_QTY' | translate }}
                  </label>
                  <p class="input-value"><strong>{{bookingMasterData.totalPickingQty}}</strong></p>
                </div>
                <div class="my-input-group inline-group" *ngIf="isContainerService">
                  <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_CONTAINERS' | translate }}</label>
                  <p class="input-value"><strong>{{bookingMasterData.totalContainers}}</strong></p>
                </div>
                <div class="my-input-group inline-group" *ngIf="this.bookingMasterData.sampleSizeVisible">
                  <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_REPORTS' | translate }}</label>
                  <p class="input-value"><strong>{{bookingMasterData.totalReports}}</strong></p>
                </div>

                <div class="my-input-group inline-group" *ngIf="bookingMasterData.IsInternalUser">
                  <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_MANDAYS' | translate }}</label>
                  <p class="input-value"><strong>{{bookingMasterData.totalManDays}}</strong></p>
                </div>

                <div class="my-input-group inline-group" *ngIf="model.customerCollectionName">
                  <label for="">{{ 'EDIT_BOOKING.LBL_COLLECTION' | translate }}</label>
                  <p class="input-value"><strong>{{model.customerCollectionName}}</strong></p>
                </div>
              </div>
            </div>


          </div>
          <div class="col-sm-6 col-md-6 col-lg-4 padding-left tablet-padding-left last-column last-preview">
            <div class="my-input-group inline-group">
              <label for="">{{ 'EDIT_BOOKING.LBL_Service_TODATE' | translate }}</label>
              <p class="input-value"><strong>{{bookingPreviewData.servicetodatepanel}}</strong></p>
            </div>
            <div class="my-input-group inline-group">
              <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_PRODUCTS' | translate }}</label>
              <p class="input-value"><strong>{{bookingMasterData.totalProducts}}</strong></p>
            </div>
            <div class="my-input-group inline-group"
              *ngIf="this.bookingMasterData.sampleSizeVisible && !isContainerService">
              <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_SAMPLING_SIZE' | translate }}</label>
              <p class="input-value"><strong>{{bookingMasterData.totalSamplingSize}}</strong></p>
            </div>
            <div class="my-input-group inline-group">
              <label for="">{{ 'EDIT_BOOKING.LBL_TOTAL_NO_OF_POS' | translate }}</label>
              <p class="input-value">
                <strong>
                  {{bookingMasterData.totalPos}}
                </strong>
              </p>
            </div>
            <div class="my-input-group inline-group">
              <label for="">{{ 'EDIT_BOOKING.LBL_DELETE_PO_LIST' | translate }}</label>

              <div class="input-value">

                <div *ngIf="bookingMasterData.poList && bookingMasterData.poList.length==1">
                  <strong>
                    {{bookingMasterData.poList}}
                  </strong>
                </div>

                <div *ngIf="bookingMasterData.poList && bookingMasterData.poList.length>1">

                  <ng-template #polistpopContent>
                    <div [ngClass]="{ 'popoverScroll': bookingMasterData.poList.length>10}" style="width: 150px;">
                      <div *ngFor="let poName of bookingMasterData.poList">
                        <span class="textfont-bold">{{poName}}</span>
                      </div>
                    </div>
                  </ng-template>
                  <p>
                    <strong>{{bookingMasterData.poList | slice:0:1 }}</strong><a
                      style="width: 50px;float: right;padding-left: 2.2%;" [ngbPopover]="polistpopContent"
                      placement="auto" [autoClose]="'outside'" popoverTitle="PO List">
                      More...
                    </a>
                  </p>


                </div>
              </div>

            </div>
            <div class="my-input-group inline-group" *ngIf="model.customerPriceCategoryName">
              <label for="">{{ 'EDIT_BOOKING.LBL_PRICE_CATEGORY' | translate }}</label>
              <p class="input-value"><strong>{{model.customerPriceCategoryName}}</strong></p>
            </div>
          </div>
          <div class="col-sm-12 col-md-12 col-lg-12" *ngIf="bookingPreviewData.priceCategoryMessage">
            <div class="row">
              <div class="col-sm-12 col-md-12 col-lg-12">
                <span class="supplier-msg">
                  {{bookingPreviewData.priceCategoryMessage}}
                </span>
              </div>
            </div>
          </div>
        </div>

        <ng-template ngFor let-item [ngForOf]="bookingPreviewData.dfCustomerConfigPreviewBaseData" let-i="index">
          <div class="row  audit-data-container" [ngClass]="{ 'marginTop15': i==0}">
            <div class="col-sm-6 col-md-6 col-lg-8">
              <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-5 border-right" *ngIf="item[0]!=null">
                  <div class="my-input-group inline-group">
                    <label for="">{{ item[0].label }}</label>
                    <p class="input-value">
                      <strong>{{item[0].value}}</strong>
                    </p>
                  </div>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-7 padding-left border-right" *ngIf="item[1]!=null">
                  <div class="my-input-group inline-group">
                    <label for="">{{ item[1].label }}</label>
                    <p class="input-value">
                      <strong>{{item[1].value}}</strong>
                    </p>
                  </div>

                </div>
              </div>
            </div>
            <div class="col-sm-6 col-md-6 col-lg-4 padding-left tablet-padding-left last-column last-preview"
              *ngIf="item[2]!=null">
              <div class="my-input-group inline-group">
                <label for="">{{ item[2].label }}</label>
                <p class="input-value">
                  <strong>{{item[2].value }}</strong>
                </p>
              </div>
            </div>
          </div>
        </ng-template>

        <div class="row audit-data-container marginTop15">
          <div class="table-container" style="overflow-x: scroll;overflow-y: scroll; max-height: 500px;width:100%">
            <table class="pagination-table simple-table bordered">
              <!-- master-body content-container table-container marginTop15 scroll-x  PreviewTable *ngIf="(bookingMasterData.bookingProductList.length>0)"-->
              <thead>
                <tr class="sticky-top-row odd">
                  <th>{{'PURCHASEORDER_SUMMARY.LBL_PO_NO' | translate }}</th>

                  <th> </th>

                  <th>{{ 'EDIT_BOOKING.LBL_PO_PRD_REFERENCE' | translate }}</th>
                  <th>{{'EDIT_BOOKING.LBL_PO_PRD_REFERENCE_DESC' | translate }}</th>

                  <th *ngIf="isContainerService">
                    {{ 'EDIT_BOOKING.EDIT_CONTAINER' | translate }}
                  </th>

                  <th *ngIf="model.businessLine==_businessLine.SoftLine">
                    {{
                    'EDIT_BOOKING.LBL_PO_PRD_COLOR_CODE' |
                    translate
                    }}
                  </th>
                  <th *ngIf="model.businessLine==_businessLine.SoftLine">
                    {{
                    'EDIT_BOOKING.LBL_PO_PRD_COLOR_NAME' |
                    translate
                    }}
                  </th>

                  <th *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                  || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                    {{ 'EDIT_BOOKING.LBL_AQL' | translate }}
                  </th>

                  <th
                    *ngIf="bookingMasterData.sampleSizeVisible && !isContainerService
                      && (bookingMasterData.userTypeId==userTypeEnum.InternalUser || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                    {{ 'EDIT_BOOKING.LBL_SAMPLING_SIZE' | translate }}
                  </th>
                  <th class="width-60">{{ 'EDIT_BOOKING.LBL_Unit' | translate }}</th>

                  <th>{{ 'EDIT_BOOKING.LBL_BOOKINGQTY' | translate }}</th>

                  <th
                    *ngIf="!isReInspection && (entPageFieldAccessEnum.Booking_Edit_POQuantity | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_BOOKING.LBL_PO_Quantity' | translate }}
                  </th>

                  <th
                    *ngIf="(entPageFieldAccessEnum.Booking_Edit_CustomerRefPo | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{
                    'EDIT_BOOKING.LBL_PO_PRODUCT_CUST_REF_PO' | translate
                    }}
                  </th>


                  <th>{{ 'EDIT_BOOKING.LBL_PRODUCTCATEGORY' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_Products_SubCategory' | translate }}</th>
                  <th
                    *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_SubCategory2 | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_BOOKING.LBL_Product_Sub2_Category' | translate }}
                  </th>
                  <th *ngIf="bookingMasterData.IsInternalUser">
                    {{ 'EDIT_BOOKING.LBL_Product_Sub3_Category' | translate }}
                  </th>

                  <th *ngIf="bookingMasterData.destinationCountryAvailable">
                    {{
                    'EDIT_BOOKING.LBL_DESTINATION_COUNTRY' |
                    translate
                    }}
                  </th>

                  <th
                    *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_Factory_Reference | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_BOOKING.LBL_FACTORY_REFERENCE' | translate }}
                  </th>

                  <th>{{ 'EDIT_PURCHASEORDER.LBL_ETD' | translate }}</th>

                  <th
                    *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_Barcode | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_CUSTOMER_PRODUCT.BARCODE' | translate }}
                  </th>
                  <th>{{ 'EDIT_BOOKING.LBL_Remarks' | translate }}</th>
                  <th>{{ 'EDIT_BOOKING.LBL_FB_TEMPLATE' | translate }}</th>
                  <th
                    *ngIf="!isContainerService && bookingMasterData.IsInternalUser && (entPageFieldAccessEnum.Booking_Edit_EcoPack | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_BOOKING.LBL_ISECOPACK' | translate }}
                  </th>
                  <th
                    *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayChild | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_BOOKING.LBL_ISDISPLAY' | translate }}
                  </th>
                  <th
                    *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayMaster | dataFieldAccessPipe :filterEntFieldAccess)">
                    {{ 'EDIT_BOOKING.LBL_DISPLAY_CHILD' | translate }}
                  </th>

                  <th *ngIf="bookingMasterData.isPicking">
                    {{ 'EDIT_BOOKING.LBL_PICKINGQTY' | translate }}
                  </th>



                </tr>
              </thead>
              <tbody>

                <ng-template ngFor let-item [ngForOf]="bookingMasterData.bookingPOProductValidators" let-i="index">

                  <tr [ngStyle]='{"background-color" : item.colorCode}'>

                    <td class="wordbreak width-100">{{item.poProductDetail.poName}}</td>

                    <td>
                      <div *ngIf="item.poProductDetail.isNewProduct" style="margin-top:5%">
                        <img src="assets/images/new.svg" alt="">
                      </div>
                    </td>

                    <td>
                      <div>{{item.poProductDetail.productName}}</div>
                    </td>
                    <td class="wordbreak width-140">
                      <ng-template #productDescpopContent>
                        <span>
                          {{item.poProductDetail.productDesc}}
                        </span>
                      </ng-template>
                      <p>
                        <span class="cursor-pointer" [ngbPopover]="productDescpopContent"
                          triggers="mouseenter:mouseleave" placement="auto" [autoClose]="'outside'"
                          popoverTitle="Product Description">
                          {{
                          item.poProductDetail.productDesc
                          | slice:0:50
                          }}
                        </span>
                      </p>



                    </td>

                    <td *ngIf="isContainerService"> {{item.poProductDetail.containerName}} </td>

                    <td class="wordbreak width-100" *ngIf="model.businessLine==_businessLine.SoftLine">
                      {{item.poProductDetail.colorCode}}
                    </td>
                    <td class="wordbreak width-100" *ngIf="model.businessLine==_businessLine.SoftLine">
                      {{item.poProductDetail.colorName}}
                    </td>

                    <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                    || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                      {{item.poProductDetail.previewAqlName}}
                    </td>


                    <td class="Center_Middle"
                      *ngIf="this.bookingMasterData.sampleSizeVisible && !isContainerService
                        && (bookingMasterData.userTypeId==userTypeEnum.InternalUser || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                      <span
                        *ngIf="item.poProductDetail.previewSamplingSize">{{item.poProductDetail.previewSamplingSize}}</span>
                    </td>
                    <td>{{item.poProductDetail.unitNameCount}}</td>

                    <td> {{item.poProductDetail.bookingQuantity}}</td>

                    <td
                      *ngIf="!isReInspection && (entPageFieldAccessEnum.Booking_Edit_POQuantity | dataFieldAccessPipe :filterEntFieldAccess)">

                      {{item.poProductDetail.poQuantity}}
                    </td>

                    <td
                      *ngIf="(entPageFieldAccessEnum.Booking_Edit_CustomerRefPo | dataFieldAccessPipe :filterEntFieldAccess)">
                      {{item.poProductDetail.customerReferencePo}}
                    </td>


                    <td>{{item.poProductDetail.productCategoryName}}</td>
                    <td>{{item.poProductDetail.productSubCategoryName}}</td>
                    <td
                      *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_SubCategory2 | dataFieldAccessPipe :filterEntFieldAccess)">
                      {{item.poProductDetail.productCategorySub2Name}}
                    </td>
                    <td *ngIf="bookingMasterData.IsInternalUser">{{item.poProductDetail.productCategorySub3Name}}</td>

                    <td *ngIf="bookingMasterData.destinationCountryAvailable">
                      {{item.poProductDetail.destinationCountryName}}
                    </td>

                    <td
                      *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_Factory_Reference | dataFieldAccessPipe :filterEntFieldAccess)"
                      class="wordbreak width-100">
                      {{item.poProductDetail.factoryReference}}
                    </td>

                    <td>
                      <span *ngIf="item.poProductDetail.etd">
                        {{item.poProductDetail.etd.day}}/{{item.poProductDetail.etd.month}}/{{item.poProductDetail.etd.year}}
                      </span>
                    </td>

                    <td
                      *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_Barcode | dataFieldAccessPipe :filterEntFieldAccess)">
                      {{item.poProductDetail.barcode}}
                    </td>
                    <td class="wordbreak">{{item.poProductDetail.remarks}}</td>
                    <td>{{item.poProductDetail.fbTemplateName}}</td>
                    <td
                      *ngIf="!isContainerService && bookingMasterData.IsInternalUser && (entPageFieldAccessEnum.Booking_Edit_EcoPack | dataFieldAccessPipe :filterEntFieldAccess)">
                      {{item.poProductDetail.isEcopack}}
                    </td>
                    <td
                      *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayChild | dataFieldAccessPipe :filterEntFieldAccess)">
                      {{item.poProductDetail.isDisplayMaster}}
                    </td>
                    <td
                      *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayMaster | dataFieldAccessPipe :filterEntFieldAccess)">
                      {{item.poProductDetail.parentProductName}}
                    </td>

                    <td *ngIf="bookingMasterData.isPicking && item.poProductDetail.pickingQuantity>0">
                      <span class="table-action common-tooltip bottom"
                        (click)="toggleExpandPickingPreview($event,i,item)" data-tooltip="view picking">
                        <img src="assets/images/new-set/view-dark.svg" alt="Picking">
                      </span>
                      {{item.poProductDetail.pickingQuantity}}
                    </td>
                  </tr>

                  <ng-container>
                    <ng-template [ngTemplateOutlet]="pickingListPreviewTemplate"
                      [ngTemplateOutletContext]="{ item: item, i:i}">
                    </ng-template>
                  </ng-container>

                  <!--  <tr class="expandable-row" [attr.data-expand-id]="i">
                    <td colspan="16">
                      <div class="table-container padding10">

                        <div class="table-container child-table">
                          <table class="pagination-table simple-table">
                            <thead>
                              <tr>
                                <th></th>
                                <th>{{'PURCHASEORDER_SUMMARY.LBL_PO_NO' | translate }}</th>

                                <th *ngIf="!isReInspection">
                                  {{ 'EDIT_BOOKING.LBL_PO_Quantity' | translate }}
                                </th>


                                <th>{{ 'EDIT_BOOKING.LBL_BOOKINGQTY' | translate }}</th>

                                <th *ngIf="isContainerService">
                                  {{ 'EDIT_BOOKING.EDIT_CONTAINER' | translate }}
                                </th>

                                <th *ngIf="bookingMasterData.isPicking">
                                  {{ 'EDIT_BOOKING.LBL_PICKINGQTY' | translate }}
                                </th>
                                <th>{{ 'EDIT_BOOKING.LBL_CUSTOMER_REFERENCE_PO' | translate }}</th>
                                <th>{{ 'EDIT_BOOKING.LBL_DESTINATION_COUNTRY' | translate }}</th>

                                <th>{{ 'EDIT_PURCHASEORDER.LBL_ETD' | translate }}</th>
                              </tr>
                            </thead>
                            <tbody>
                              <ng-template ngFor let-poDetail [ngForOf]="item.productPODetails" let-p="index">
                                <tr *ngIf="poDetail && poDetail.poProductData" [ngClass]="p%2 !== 0?'even':'odd' ">
                                  <td></td>
                                  <td class="wordbreak">{{poDetail.poProductData.poName}}</td>
                                  <td *ngIf="!isReInspection">
                                    {{poDetail.poProductData.poQuantity}}
                                  </td>

                                  <td>
                                    {{poDetail.poProductData.bookingQuantity}}

                                  </td>


                                  <td *ngIf="isContainerService">
                                    {{poDetail.poProductData.containerName}}

                                  </td>



                                  <td *ngIf="bookingMasterData.isPicking">
                                    {{poDetail.poProductData.pickingQuantity}}
                                  </td>
                                  <td>{{poDetail.poProductData.customerReferencePo}}
                                  <td *ngIf="bookingMasterData.destinationCountryAvailable">
                                    {{poDetail.poProductData.destinationCountryName}}
                                  </td>



                                  <td *ngIf="poDetail.poProductData.etd != null">
                                    {{poDetail.poProductData.etd.day}}/{{poDetail.poProductData.etd.month}}/{{poDetail.poProductData.etd.year}}
                                  </td>
                                  <td *ngIf="poDetail.poProductData.etd == null"></td>
                                </tr>
                              </ng-template>


                            </tbody>
                          </table>


                        </div>

                      </div>
                    </td>
                  </tr> -->
                </ng-template>

              </tbody>
            </table>
          </div>
        </div>

        <div class="row marginTop25 mobile-margin-top-15">
          <div class="col-sm-12">
            <div class="confirmation-title-container">
              <img src="assets/images/audit-step-4.svg" alt="">
              <h4 class="title">{{'EDIT_BOOKING.LBL_TECHNICAL_DOC' | translate}}</h4>
              <button class="secondary-cta x-small" (click)="openPanelFromPreview(panelData.Step3)">
                {{ 'EDIT_BOOKING.LBL_EDIT' | translate}}
              </button>
            </div>
          </div>
        </div>

        <div class="row audit-data-container">
          <div class="col-sm-10 col-md-12 col-lg-10">
            <div class="row">
              <div class="col-sm-4 col-md-6 col-lg-4 border-right">
                <div class="document-count-container">
                  <img src="assets/images/uploaded-files.svg" alt="Uploaded Files">
                  <div class="info">
                    <h4 class="count">{{bookingMasterData.inspectionFileAttachments.length}}</h4>
                    <p>{{'EDIT_BOOKING.LBL_TECHNICAL_DOC_UPD' | translate}}</p>
                    <span></span>
                  </div>
                </div>
              </div>
              <div class="col-sm-4 col-md-6 col-lg-4 padding-left tablet-padding-left last-column border-right ">
                <div class="my-input-group">
                  <label for="">{{'EDIT_BOOKING.LBL_COMMENTS_ENTITY' | translate}}</label>
                  <p class="input-value text-wrap">
                    <strong>{{model.apiBookingComments}}</strong>
                  </p>
                </div>
              </div>
              <div class="col-sm-4 col-md-6 col-lg-4 padding-left tablet-padding-left last-column">
                <div class="my-input-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_CUSTOMER_BOOKING_COMMENTS' | translate}}</label>
                  <p class="input-value text-wrap">
                    <strong>{{model.cusBookingComments}}</strong>
                  </p>
                </div>
              </div>
            </div>



            <div class="row marginTop25" *ngIf="!bookingMasterData.IsInternalUser">
              <div class="col-sm-4 col-md-6 col-lg-4">
                <div class="styled-checkbox-container">
                  <input class="styled-checkbox" id="checkbox-terms" type="checkbox" [(ngModel)]="model.isTermsChecked">
                  <label style="font-size: 13px;" for="checkbox-terms">
                    {{ 'EDIT_BOOKING.LBL_I_AGREE' | translate }}<a id="lnkcheckbox-terms" (click)="getBookingTerms()">
                      {{
                      'EDIT_BOOKING.LBL_BOOKING_TERMS_CONDIIONS'
                      | translate
                      }}
                    </a>
                  </label>
                </div>
              </div>
              <div class="col-sm-4 col-md-6 col-lg-4 "
                *ngIf="model.bookingType!=_inspectionBookingTypeEnum.UnAnnounced && !model.isEaqf">
                <div class="styled-checkbox-container">
                  <input class="styled-checkbox" id="checkbox-supEmail" type="checkbox"
                    [(ngModel)]="model.isSupplierOrFactoryEmailSend">
                  <label for="checkbox-supEmail">{{ 'EDIT_BOOKING.LBL_SUPPLIER_FACTORY_EMAIL' | translate }}</label>
                </div>
              </div>
            </div>

          </div>
          <div class="col-sm-1 col-md-12 col-lg-2 padding-left"></div>
        </div>

        <div class="row marginTop25 mobile-margin-top-15" *ngIf="bookingMasterData.IsInternalUser">
          <div class="col-sm-12">
            <div class="confirmation-title-container">
              <img src="assets/images/audit-step-1.svg" alt="">
              <h4 class="title">{{ 'EDIT_BOOKING.LBL_MAIN_DETAILS' | translate }}</h4>
              <button class="secondary-cta x-small" (click)="openPanelFromPreview(panelData.Step4)">
                {{ 'EDIT_BOOKING.LBL_EDIT' | translate}}
              </button>
            </div>
          </div>
        </div>

        <div class="row audit-data-container" *ngIf="bookingMasterData.IsInternalUser">
          <div class="col-sm-10 col-md-12 col-lg-10">
            <div class="row">
              <div class="col-sm-2 col-md-2 col-lg-2 ">
                <div class="my-input-group">
                  <label for="">{{ 'EDIT_BOOKING.LBL_OFFICE' | translate }}</label>
                  <p class="input-value">
                    <strong>{{bookingPreviewData.Officename}}</strong>
                  </p>
                </div>
              </div>
              <div class="col-sm-2 col-md-2 col-lg-2 border-right">
                <div class="my-input-group">
                  <label for="">{{'BOOKING_SUMMARY.LBL_AE' | translate}}</label>
                  <p class="input-value wordbreak"><strong>{{model.csNames}}</strong></p>
                </div>
              </div>
              <div class="col-sm-4 col-md-4 col-lg-4 padding-left tablet-padding-left last-column border-right">
                <div class="my-input-group">
                  <label for="">{{'EDIT_BOOKING.LBL_INTERNAL_COMMENTS' | translate}}</label>
                  <p class="input-value text-wrap">
                    <strong>{{model.internalComments}}</strong>
                  </p>
                </div>
              </div>
              <div class="col-sm-4 col-md-4 col-lg-4 padding-left tablet-padding-left last-column ">
                <div class="my-input-group">
                  <label for="">{{'EDIT_BOOKING.LBL_QC_COMMENT' | translate}}</label>
                  <p class="input-value text-wrap">
                    <strong>{{model.qcBookingComments}}</strong>
                  </p>
                </div>
              </div>
            </div>

            <div class="row marginTop25" *ngIf="model.statusId == _bookingStatus.Hold">
              <div class="col-sm-2 col-md-6 col-lg-4">
                <div class="my-input-group">
                  <label for="">{{'EDIT_BOOKING.LBL_HOLD_REASON_TYPE' | translate}}</label>
                  <p class="input-value text-wrap">
                    <strong>{{model.holdReasonType}}</strong>
                  </p>
                </div>
              </div>

              <div class="col-sm-2 col-md-6 col-lg-4">
                <div class="my-input-group">
                  <label for="">{{'EDIT_BOOKING.LBL_HOLD_REASON' | translate}}</label>
                  <p class="input-value text-wrap">
                    <strong>{{model.holdReason}}</strong>
                  </p>
                </div>
              </div>
            </div>

            <div class="row marginTop25">
              <div class="col-sm-3 col-md-6 col-lg-4 "
                *ngIf="model.bookingType!=_inspectionBookingTypeEnum.UnAnnounced && !model.isEaqf">
                <div class="styled-checkbox-container">
                  <input class="styled-checkbox" id="checkbox-supEmail" type="checkbox"
                    [(ngModel)]="model.isSupplierOrFactoryEmailSend">
                  <label for="checkbox-supEmail">{{ 'EDIT_BOOKING.LBL_SUPPLIER_FACTORY_EMAIL' | translate }}</label>
                </div>
              </div>

              <div class="col-sm-4 col-md-6 col-lg-4 last-column" *ngIf="!model.isEaqf"
                [ngClass]="{ 'padding-left tablet-padding-left': model.bookingType!=_inspectionBookingTypeEnum.UnAnnounced }">

                <div class="styled-checkbox-container">
                  <input class="styled-checkbox" id="checkbox-cusEmail" type="checkbox"
                    [(ngModel)]="model.isCustomerEmailSend">
                  <label for="checkbox-cusEmail">{{ 'EDIT_BOOKING.LBL_CUSTOMER_EMAIL' | translate }}</label>
                </div>
              </div>


            </div>
          </div>
          <div class="col-sm-1 col-md-12 col-lg-2 padding-left"></div>
        </div>

        <div class="cta-container text-right border-top">
          <!--   <button *ngIf="fromSummary" (click)="returnToPreviouspage()" class="secondary-cta"
            [disabled]="bookingMasterData.Initialloading">
            {{
            'EDIT_BOOKING.LBL_RETURN' | translate
            }}
          </button> -->
          <button class="primary-cta" [ngStyle]="{'display': bookingMasterData.IsSaveBtnShow?'inline-block':'none'}"
            [disabled]="bookingMasterData.pageLoader || bookingMasterData.savedataloading  || bookingMasterData.Initialloading || bookingMasterData.suploading || bookingMasterData.supplierloading || bookingMasterData.factoryloading"
            (click)="saveInspectionBooking()">
            {{
            'EDIT_BOOKING.LBL_SAVE' | translate
            }}
          </button>
          <button *ngIf="bookingMasterData.pageLoader || bookingMasterData.IsverifyBtnShow" class="primary-cta"
            [disabled]="bookingMasterData.savedataloading || bookingMasterData.Initialloading || bookingMasterData.cusloading
                  || bookingMasterData.suploading
                  || bookingMasterData.supplierloading || bookingMasterData.factoryloading "
            (click)="confirmORVerifyBooking(verifyBooking,8)">
            {{'EDIT_BOOKING.BTN_VERIFY' | translate}}
          </button>

          <button *ngIf=" bookingMasterData.pageLoader || bookingMasterData.IsholdBtnShow" class="secondary-cta"
            [disabled]="bookingMasterData.savedataloading || bookingMasterData.Initialloading || bookingMasterData.cusloading
                || bookingMasterData.suploading
                || bookingMasterData.supplierloading || bookingMasterData.factoryloading "
            (click)="openHoldBooking(holdBooking)">
            {{'EDIT_BOOKING.BTN_HOLD' | translate}}
          </button>

          <button *ngIf="bookingMasterData.pageLoader || bookingMasterData.IsConfirmEmainBtnShow" class="secondary-cta"
            [disabled]="bookingMasterData.savedataloading || bookingMasterData.Initialloading || bookingMasterData.cusloading
          || bookingMasterData.suploading || bookingMasterData.factloading
          || bookingMasterData.supplierloading || bookingMasterData.factoryloading "
            (click)="openConfirmEmailPopup(confirmEmail)">
            {{'EDIT_BOOKING.BTN_CONFIRM_EMAIL' | translate}}
          </button>

          <button *ngIf="bookingMasterData.pageLoader || bookingMasterData.IsconfirmBtnShow" class="primary-cta"
            [disabled]="bookingMasterData.savedataloading || bookingMasterData.Initialloading || bookingMasterData.cusloading
                  || bookingMasterData.suploading || bookingMasterData.factloading
                  || bookingMasterData.supplierloading || bookingMasterData.factoryloading "
            (click)="confirmORVerifyBooking(conformBooking,2)">
            {{'EDIT_BOOKING.BTN_CONFIRM' | translate}}
          </button>
        </div>

        <!-- <div class="confirmation-loader" *ngIf="bookingMasterData.savedataloading">
          <div class="loader">
            <img src="assets/images/loader.gif" alt="Loader">
            <p>Please wait...</p>
          </div>
        </div> -->

      </div>
    </div>

    <!--#endregion PreviewContainer-->

  </div>

  <!--#region Success Container-->
  <div class="success-container" *ngIf="bookingMasterData.issuccess">
    <div class="success-box">
      <div class="head">
        <img src="assets/images/flight.svg" alt="success">
      </div>
      <div class="body">
        <div class="oval"></div>
        <h3 class="title">
          {{ 'EDIT_BOOKING.BOOKING_SUCCESS_TITLE1' | translate }}<br>
          {{ 'EDIT_BOOKING.BOOKING_SUCCESS_TITLE2' | translate }}
        </h3>
        <p class="text order-success">{{ 'EDIT_BOOKING.BOOKING_SUCCESS_TITLE3' | translate }} </p>
        <span class="audit-id">#{{model.id}}</span>
        <div class="cta-container">
          <button class="secondary-cta small" (click)="successNewBooking()">
            {{ 'EDIT_BOOKING.NEWBOOKING' | translate }}
          </button>
          <button class="secondary-cta small" (click)="returnwithsearchparam('inspsummary/booking-summary',model.id)">
            {{ 'EDIT_BOOKING.ORDERTRACKING' | translate }}
          </button>
          <button class="secondary-cta small"
            *ngIf="model.isCombineRequired && model.statusId != _bookingStatus.Cancel && !isContainerService"
            (click)="returnwithsearchparam('inspcombine/edit-combineorders',model.id)">
            {{'BOOKING_COMBINEORDERS.TITLE' | translate}}
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--#endregion Success Container-->

</div>

<!--#region Product View Popup-->
<ng-template #productImage let-modal>
  <div class="modal-header custom-modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{'EDIT_BOOKING.VIEW_PRODUCT_TITLE' | translate}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body custom-modal-body">
    <ngx-gallery [options]="productGalleryOptions" [images]="productGalleryImages"></ngx-gallery>
  </div>
</ng-template>
<!--#endregion Product View Popup-->
<!--#region Customer Product Popup-->
<ng-template #content let-modal>
  <div class="modal-header custom-modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ 'EDIT_CUSTOMER_PRODUCT.ADD_NEW_TITLE' | translate }}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body custom-modal-body">
    <app-editCustomerProduct [modelData]="modalInputData"></app-editCustomerProduct>
  </div>
</ng-template>
<!--#endregion Customer Product Popup-->
<!--#region Supplier Creation Popup-->
<ng-template #contentsupplier let-modal>
  <div class="modal-header custom-modal-header">
    <h4 class="modal-title" *ngIf="modalInputData.typeId==1" id="modal-basic-title">
      {{ 'EDIT_BOOKING.LBL_FACTORY_DETAILS' | translate }}
    </h4>
    <h4 class="modal-title" *ngIf="modalInputData.typeId==2" id="modal-basic-title">
      {{ 'EDIT_BOOKING.LBL_SUPPLIER_DETAILS' | translate }}
    </h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body custom-modal-body">
    <app-edit-supplier-lite [modelData]="modalInputData"></app-edit-supplier-lite>
  </div>
</ng-template>
<!--#endregion Supplier Creation Popup-->
<!--#region Confirm Booking Popup-->
<ng-template #conformBooking let-modal>
  <div class="modal-body">
    <div class="small-model">

      <h2 class="title">{{ 'EDIT_BOOKING.LBL_CONFIRM_BOOKING' | translate }}</h2>

      <p>{{ 'EDIT_BOOKING.LBL_CONFIRM_BOOKING_CHECK' | translate }} </p>

      <button class="secondary-cta" (click)="modal.dismiss('Cross click')">
        {{
        'COMMON.LBL_CONFIRMCANCEL' | translate
        }}
      </button>

      <button class="primary-cta" (click)="updateConfirmBooking();">
        {{ 'COMMON.LBL_OK' | translate }}
      </button>

    </div>
  </div>

</ng-template>
<!--#endregion Confirm Booking Popup-->
<!--#region Verify Booking Popup-->
<ng-template #verifyBooking let-modal>

  <div class="modal-body">
    <div class="small-model">

      <h2 class="title">{{ 'EDIT_BOOKING.LBL_VERIFY_BOOKING' | translate }}</h2>

      <p>{{ 'EDIT_BOOKING.LBL_VERIFY_BOOKING_CHECK' | translate }} </p>

      <button class="secondary-cta" (click)="modal.dismiss('Cross click')">
        {{
        'COMMON.LBL_CONFIRMCANCEL' | translate
        }}
      </button>

      <button class="primary-cta" (click)="updateConfirmBooking();">
        {{ 'COMMON.LBL_OK' | translate }}
      </button>

    </div>
  </div>
</ng-template>
<!--#endregion Verify Booking Popup-->
<!--#region Confirm Email Popup-->
<ng-template #confirmEmail let-modal>

  <div class="modal-body">
    <div class="small-model">

      <h2 class="title">{{ 'EDIT_BOOKING.LBL_CONFIRM_EMAIL' | translate }}</h2>

      <p>{{ 'EDIT_BOOKING.LBL_CONFIRM_EMAIL_CHECK' | translate }} </p>

      <button class="secondary-cta" (click)="modal.dismiss('Cross click')">
        {{
        'COMMON.LBL_CONFIRMCANCEL' | translate
        }}
      </button>

      <button class="primary-cta" (click)="sendConfirmEmail();">
        {{ 'COMMON.LBL_OK' | translate }}
      </button>

    </div>
  </div>
</ng-template>
<!--#endregion Confirm Email Popup-->

<ng-template #pickingDescription let-modal>
  <div class="modal-header custom-modal-header">
    <h4>{{'EDIT_BOOKING.LBL_SAMPLE_PICKING_INSTRUCTIONS' | translate }}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body custom-modal-body">
    <p>{{ 'EDIT_BOOKING.LBL_PICKING_DESC' | translate }} </p>
  </div>
</ng-template>

<!--#region Hold Booking Popup-->
<ng-template #holdBooking let-modal>
  <div class="modal-body header-small-modal">
    <div class="small-model">
      <div class="head">
        <h6>{{ 'EDIT_BOOKING.LBL_HOLD_BOOKING' | translate }}</h6>
        <img src="assets/images/black-close.svg" alt="close" class="close" (click)="modal.dismiss('Cross click')">
      </div>
      <div class="body">

        <div class="my-input-group marginTop20">
          <label class="required" for="">{{ 'EDIT_BOOKING.LBL_HOLD_BOOKING_REASON_TYPE' | translate }}</label>
          <ng-select [searchable]="true" [items]="bookingMasterData.inspectionHoldReasonTypes" bindLabel="name"
            [clearable]="false" [loading]="bookingMasterData.Initialloading"
            [ngClass]="{ 'is-invalid': !validator.isValid('holdReasonTypeId')}" bindValue="id" [hideSelected]="true"
            placeholder="--- {{(bookingMasterData.inspectionHoldReasonTypes!=null && bookingMasterData.inspectionHoldReasonTypes.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
            [(ngModel)]="model.holdReasonTypeId" appendTo="body">
            <ng-template ng-option-tmp let-item="item">
              <div class="text-wrap">{{ item.name }}</div>
            </ng-template>
          </ng-select>

          <div *ngIf="!validator.isValid('holdReasonTypeId')" class="invalid-feedback" style="display:block">
            <div *ngFor="let error of validator.getErrors('holdReasonTypeId')">{{ error | translate }}</div>
          </div>

        </div>


        <div class="my-input-group marginTop20">
          <label class="required" for="">{{ 'EDIT_BOOKING.LBL_HOLD_BOOKING_COMMENTS' | translate }}</label>
          <textarea [(ngModel)]="model.holdReason" [ngClass]="{ 'is-invalid': !validator.isValid('holdReason')}"
            placeholder="Text goes here"></textarea>
          <div *ngIf="!validator.isValid('holdReason')" class="invalid-feedback" style="display:block">
            <div *ngFor="let error of validator.getErrors('holdReason')">{{ error | translate }}</div>
          </div>
        </div>
        <div class="marginTop20 text-right">
          <button class="secondary-cta" (click)="modal.dismiss('Cross click')">
            {{
            'EDIT_BOOKING.LBL_HOLD_BOOKING_CANCEL' | translate
            }}
          </button>
          <button class="primary-cta" (click)="holdBookingConfirm();">
            {{
            'EDIT_BOOKING.LBL_HOLD_BOOKING_DONE' |
            translate
            }}
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<!--#endregion Hold Booking Popup-->
<ng-template #confirmRemovePicking let-modal>

  <div class="modal-body">
    <div class="small-model">

      <h2 class="title">{{ 'EDIT_BOOKING.LBL_REMOVE_PICKING_DATA' | translate }}</h2>

      <p>{{ 'EDIT_BOOKING.LBL_CONFIRM_REMOVE_PICKING' | translate }} </p>

      <button class="secondary-cta" (click)="closeRemovePickingData()">
        {{
        'COMMON.LBL_CONFIRMCANCEL' | translate
        }}
      </button>

      <button class="primary-cta" (click)="removePickingData();">
        {{ 'COMMON.LBL_OK' | translate }}
      </button>

    </div>
  </div>
</ng-template>

<!--#region Add Booking Product Popup-->
<!-- <ng-template #addBookingProduct let-modal>
  <div class="modal-body header-small-modal">
    <div class="small-model">
      <div class="head" style="background-color: #78dc8f">
        <h6>{{ 'EDIT_BOOKING.LBL_PRD_ADD_PO_SUCCESS' | translate }}</h6>
        <img src="assets/images/black-close.svg" alt="close" class="close" (click)="modal.dismiss('Cross click')">
      </div>
      <div class="body">

        <div class="my-input-group marginTop20">
          <h5><span for="">{{ 'EDIT_BOOKING.LBL_PRD_ADD_WANT_TO_ADDPO_BOOKING' | translate }}</span></h5>
        </div>
        <div class="marginTop20 text-right">
          <button class="secondary-cta" (click)="closeNewProductsBooking();">
            {{
            'EDIT_BOOKING.LBL_PRD_ADD_CANCEL' |
            translate
            }}
          </button>
          <button class="primary-cta" (click)="addPurchaseOrderPopupDataToBooking();">
            {{
            'EDIT_BOOKING.LBL_PRD_ADD_OK' |
            translate
            }}
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template> -->


<ng-template #addBookingProduct let-modal>
  <div class="delete-popup-container">
    <div class="content">
      <img src="assets/images/img.png" alt="">
      <div class="title-container">
        <h3>{{ 'EDIT_BOOKING.LBL_PRD_ADD_PO_SUCCESS' | translate }}</h3>
        <p>{{ 'EDIT_BOOKING.LBL_PRD_ADD_WANT_TO_ADDPO_BOOKING' | translate }}</p>
      </div>
    </div>
    <div class="text-right">
      <button class="secondary-cta link" (click)="modal.dismiss('Cross click')">
        {{
        'EDIT_BOOKING.LBL_PRD_ADD_CANCEL' |
        translate
        }}
      </button>
      <button class="primary-cta" (click)="addPurchaseOrderPopupDataToBooking();">
        {{
        'EDIT_BOOKING.LBL_PRD_ADD_OK' |
        translate
        }}
      </button>
    </div>
  </div>
</ng-template>

<!--#endregion Add Booking Product Popup-->
<!--#region Common Field Popup-->
<ng-template #CommonFieldPopUp let-modal>
  <div class="modal-body">
    <div class="small-model new-padding">
      <h2 class="confirm-title">
        <img class="mr-2" src="assets/images/exclamation-icon.svg" alt="">{{
        'EDIT_BOOKING.LBL_CONFIRMSTATUSTITLE' | translate
        }}
      </h2>
      <p class="light">{{ commonfieldApplyMsg }} </p>
      <div class="text-right">
        <button class="tertiary-cta small" (click)="cancelCommonFeild();">
          {{ 'COMMON.LBL_CONFIRMCANCEL' | translate }}
        </button>
        <button class="primary-cta small" (click)="applyCommonField();">
          {{
          'COMMON.LBL_OK' | translate
          }}

        </button>
      </div>
    </div>
  </div>
</ng-template>

<!--#endregion Common Field Popup-->

<ng-template #AddPoProductPopUp let-modal>



  <div class="order-tracking-popup-container">
    <div class="po-details-container">
      <!-- <div class="back-container" (click)=backToPoProductPopup()>
          <img src="assets/images/new-set/back-dark.svg" alt="">
        </div> -->
      <div class="info-container">
        <button type="button" class="close" aria-describedby="modal-title" (click)="modal.dismiss('Cross click')">
          <img src="assets/images/black-close.svg" alt="" (click)="modal.dismiss('Cross click')">
        </button>

        <h3 class="title">
          {{ 'EDIT_BOOKING.LBL_PRODUCT_POPUP_ADD_PRD' | translate }}
        </h3>

        <!--  <p class="subtitle">
            {{ 'EDIT_BOOKING.LBL_PRODUCT_POPUP_ADD_PRD_PO' | translate }} <span class="highlight-badge">{{
              purchaseModel.pono}}</span>
          </p> -->


        <div style="margin-top: 2%;">
          <app-editCustomerProduct [modelData]="modalInputData"
            (closeProductPopupFromBooking)="closeProductPopupFromBooking($event)">
          </app-editCustomerProduct>
        </div>

      </div>
    </div>
  </div>




</ng-template>

<ng-template #importBulkPurchaseOrders let-modal>

  <div class="order-tracking-popup-container">
    <div class="po-details-container">

      <div class="info-container">
        <button type="button" class="close" aria-describedby="modal-title" (click)="modal.dismiss('Cross click')">
          <img src="assets/images/black-close.svg" alt="" (click)="modal.dismiss('Cross click')">
        </button>

        <h3 class="title">
          {{ 'EDIT_BOOKING.LBL_IMPORT_ORDERS' | translate }}
        </h3>


        <div style="margin-top: 2%;">
          <app-upload-purchaseorder-lite [modelData]="modalInputData"
            (closeUploadPoProductFromBooking)="closeUploadPoProductFromBooking($event)" [modelData]="modalInputData">
          </app-upload-purchaseorder-lite>
        </div>

      </div>
    </div>
  </div>




</ng-template>

<!--#region Delete Po List Popup-->

<ng-template #deletePoList let-modal>

  <ng-container>

    <div class="common-popup-container booking-step-container" style="background-color:transparent;">

      <div class="step-body">
        <img src="assets/images/black-close.svg" alt="" class="close" (click)="modal.dismiss('Cross click')">

        <h3 class="title" *ngIf="!this.purchaseModel.id">
          {{ 'EDIT_BOOKING.LBL_POPUP_DELETE_PO' | translate }}
        </h3>

        <div class="row marginTop15">
          <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
            <div class="my-input-group">
              <ng-select [items]="bookingMasterData.selectedPOList" [multiple]="false" [closeOnSelect]="true"
                [searchable]="true" bindLabel="name" bindValue="id" [loading]="initialLoading" appendTo="body"
                [clearable]="true" placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                (change)="changeCommonPONo($event)" [(ngModel)]="bookingMasterData.selectedCommonPONo"
                (clear)="clearCommonPoNo()">
                <ng-template ng-option-tmp let-item="item">
                  <div class="text-wrap">{{ item.name }}</div>
                </ng-template>
              </ng-select>
            </div>
          </div>
        </div>


        <div class="record-count pl-0 pr-0 align-items-end mt-2"
          *ngIf="bookingMasterData.selectedDeletePoDetails.length>0">
          <div class="column d-flex align-items-xl-center flex-sm-column flex-xl-row inspection-table-badge-wrapper"
            style="margin-left: 0px;">
            <p class="count mr-2">Select the products to delete</p>
            <div class="inspection-table-badge-container">
              <div class="inspection-badge" *ngIf="productValidateMaster.totalProducts">
                <p>
                  {{ 'EDIT_BOOKING.LBL_TOTAL' | translate }}
                  {{ 'EDIT_BOOKING.LBL_PRODUCTS' | translate }}
                  <span>{{productValidateMaster.totalProducts}}</span>
                </p>
              </div>
              <div class="inspection-badge" *ngIf="productValidateMaster.deleteSuccessCount">
                <p style="color: green;">
                  {{
                  'EDIT_BOOKING.LBL_PO_DELETE' | translate
                  }} {{
                  'EDIT_BOOKING.LBL_PO_DELETE_SUCCESS' |
                  translate
                  }}
                  <span>{{productValidateMaster.deleteSuccessCount}}</span>
                </p>

              </div>

              <div class="inspection-badge" *ngIf="productValidateMaster.validationFailedCount">
                <p style="color: green;">
                  {{
                  'EDIT_BOOKING.LBL_PO_DELETE' | translate
                  }} {{
                  'EDIT_BOOKING.LBL_PO_DELETE_FAILED' | translate
                  }}
                  <span>{{productValidateMaster.validationFailedCount}}</span>
                </p>

              </div>


            </div>
          </div>
        </div>


        <div class="table-container booking-table-container h-scroll table-max-height-400"
          *ngIf="bookingMasterData.selectedDeletePoDetails.length>0">
          <table class="pagination-table bordered">
            <thead>
              <tr>
                <th class="width-60 Center_Middle">
                  <div class="styled-checkbox-container">
                    <input class="styled-checkbox" id="checkbook" [checked]="bookingMasterData.selectAllDeletePOChecked"
                      [disabled]="bookingMasterData.disableAllPOChecked" type="checkbox"
                      (change)="selectAllDeletePoCheckBox()">
                    <label for="checkbook"></label>
                  </div>
                </th>
                <th>{{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_REMARKS' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_PRODUCT_ID' | translate }}</th>

                <th *ngIf="model.serviceTypeId==inspectionServiceType.Container">
                  {{
                  'EDIT_BOOKING.LBL_DELETE_POPOPUP_CONTAINER_NAME' | translate
                  }}
                </th>

                <th>{{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_PRODUCT_Desc' | translate }}</th>

                <th *ngIf="model.businessLine==_businessLine.SoftLine">Color Code</th>
                <th *ngIf="model.businessLine==_businessLine.SoftLine">Color Name</th>

                <th>{{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_PO_QTY' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_ETD' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_DEST_COUNTRY' | translate }}</th>

              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of bookingMasterData.selectedDeletePoDetails;let idx = index">
                <td class="width-60 Center_Middle">
                  <div class="styled-checkbox-container">
                    <input class="styled-checkbox" id="{{item.index}}" type="checkbox" [disabled]="item.disablePO"
                      [(ngModel)]="item.isPoSelected" (ngModelChange)="checkAllSelected(item)">
                    <label for="{{item.index}}"></label>
                  </div>
                </td>
                <td class="width-180"
                  [ngStyle]="{'color': item.status==1?'green':'red','text-align':item.status==1?'center':'initial'}"
                  [innerHTML]="item.remarks"></td>
                <td class="width-100">{{item.productName}}</td>
                <td *ngIf="model.serviceTypeId==inspectionServiceType.Container" class="width-100">
                  {{item.containerName}}
                </td>

                <td class="width-180">{{item.productDesc}}</td>
                <td class="width-60" *ngIf="model.businessLine==_businessLine.SoftLine">{{item.colorCode}}</td>
                <td class="width-100" *ngIf="model.businessLine==_businessLine.SoftLine">{{item.colorName}}</td>
                <td class="width-60">{{item.poQty}}</td>
                <td class="width-100">{{item.etd}}</td>
                <td class="width-100">{{item.destinationCountry}}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="cta-container">
          <button type="button" class="primary-cta small" style="float: right;margin-top: 1.5%;"
            [disabled]="!bookingMasterData.selectedCommonPONo || (!bookingMasterData.isDeleteAllPOChecked && bookingMasterData.deletePopupLoading)"
            (click)="deletePOProducts()">
            {{ 'EDIT_BOOKING.LBL_DELETE_POPOPUP_DELETE' | translate }}
            <span *ngIf="bookingMasterData.deletePopupLoading">
              <i class="fa fa-refresh fa-spin" aria-hidden="true"></i>
            </span>
          </button>

        </div>

        <div style="display: inline-flex;">
          <div style="font-size: smaller;color: red;float:left;">
            {{ 'EDIT_BOOKING.LBL_PO_DELETE_REMARKS' | translate }}
          </div>
        </div>
      </div>




    </div>
  </ng-container>








</ng-template>

<!--#endregion Delete Po List Popup-->

<ng-template #searchPOProductList let-modal>

  <ng-container>

    <div class="common-popup-container booking-step-container" style="background-color:transparent;">

      <div class="step-body">
        <img src="assets/images/black-close.svg" alt="" class="close" (click)="modal.dismiss('Cross click')">

        <h3 class="title">
          {{ 'EDIT_BOOKING.LBL_SEARCH_PRD_LST_PO' | translate }} <span class="highlight-badge">
            {{
            bookingMasterData.searchPoName
            }}
          </span>
        </h3>




        <div class="record-count pl-0 pr-0 align-items-end">
          <div class="column d-flex align-items-xl-center flex-sm-column flex-xl-row inspection-table-badge-wrapper"
            style="margin-left: 0px;">
            <p class="count mr-2">{{ 'EDIT_BOOKING.LBL_SEARCH_PRD_SEL_BLW_PRD' | translate }}</p>
          </div>
        </div>

        <div class="record-count"
          *ngIf="bookingMasterData.selectedSearchPoDetails && bookingMasterData.selectedSearchPoDetails.length>0">
          <div class="column">
            <p class="count">Showing {{ bookingMasterData.selectedSearchPoDetails.length }} records</p>
          </div>
          <div class="column"></div>
        </div>

        <div class="table-container booking-table-container mt-4 h-scroll table-max-height-400">
          <table class="pagination-table bordered">
            <thead>
              <tr class="sticky-top-row">

                <th class="width-60 Center_Middle">
                  <div class="styled-checkbox-container">
                    <input class="styled-checkbox" id="checkbook" [checked]="bookingMasterData.selectAllSearchPOChecked"
                      type="checkbox" (change)="selectAllSearchPoCheckBox()">
                    <label for="checkbook"></label>
                  </div>
                </th>

                <th>{{ 'EDIT_BOOKING.LBL_SEARCH_PO_PRD_CODE' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_SEARCH_PO_PRD_DESC' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_SEARCH_PO_PO_QTY' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_SEARCH_PO_ETD' | translate }}</th>
                <th>{{ 'EDIT_BOOKING.LBL_SEARCH_PO_DEST_COUNTRY' | translate }}</th>

              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of bookingMasterData.selectedSearchPoDetails;let idx = index">

                <td class="width-60 Center_Middle">
                  <div class="styled-checkbox-container">
                    <input class="styled-checkbox" id="searchpoCheck-{{idx}}" type="checkbox"
                      [(ngModel)]="item.isPoSelected" (ngModelChange)="checkAllSearchPoSelected(item)">
                    <label for="searchpoCheck-{{idx}}"></label>
                  </div>
                </td>

                <td class="width-140">{{item.productName}}</td>

                <td class="width-140">{{item.productDesc}}</td>

                <td class="width-60">{{item.poQty}}</td>

                <td class="width-100">
                  <span *ngIf="item.etd">
                    {{item.etd.day}}/{{item.etd.month}}/{{item.etd.year}}
                  </span>
                </td>

                <td class="width-100">{{item.destinationCountryName}}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="cta-container">

          <button type="button" [disabled]="!isProductCheckedinPopUp" class="primary-cta small"
            style="float: right;margin-top: 1.5%;" (click)="addSearchPoProducts(addBookingSearchProduct)">
            {{ 'EDIT_BOOKING.LBL_SEARCH_PO_ADD_TO_BOOKING' | translate }}
            <span *ngIf="bookingMasterData.deletePopupLoading">
              <i class="fa fa-refresh fa-spin" aria-hidden="true"></i>
            </span>
          </button>

        </div>

      </div>

    </div>
  </ng-container>
</ng-template>


<ng-template #addBookingSearchProduct let-modal>
  <div class="delete-popup-container">
    <div class="content">
      <img src="assets/images/img.png" alt="">
      <div class="title-container">
        <h3>{{ 'EDIT_BOOKING.LBL_SEARCH_PO_ADD_PRD_TO_BOOKING' | translate }}</h3>
        <p>{{ 'EDIT_BOOKING.LBL_PRD_ADD_WANT_TO_ADDPO_BOOKING' | translate }}</p>
      </div>
    </div>
    <div class="text-right">
      <button class="secondary-cta link" (click)="modal.dismiss('Cross click')">
        {{
        'EDIT_BOOKING.LBL_PRD_ADD_CANCEL' |
        translate
        }}
      </button>
      <button class="primary-cta" (click)="addSearchPoProductDataToBooking();">
        {{
        'EDIT_BOOKING.LBL_PRD_ADD_OK' |
        translate
        }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template #FactoryLeadDayPopup let-modal>
  <div class="modal-header custom-modal-header">
    <h4>{{'EDIT_BOOKING.LBL_SERVICE_DATE_RESTRICTION' | translate }}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body custom-modal-body">
    <div class="row booking-rule-container ng-star-inserted active">

      <div class="col-sm-6">
        <div class="rules-container" style="padding-left: 12px;">
          <h4 class="title">{{'EDIT_BOOKING.LBL_SERVICE_DATE_RULE' | translate }}</h4>
          <p class="text">{{this._serviceLeadDayMessage}}</p>
        </div>
      </div>

      <div class="col-sm-6" *ngIf="bookingMasterData.officedetails.officeAddress">

        <div class="office-info-container">
          <div class="office-info">
            <h4 class="title">Office Address</h4>
            <p class="text wordbreak">
              {{bookingMasterData.officedetails.officeName}}<br>{{bookingMasterData.officedetails.officeAddress}}
            </p>
            <ul class="contact-list">
              <li *ngIf="bookingMasterData.officedetails.officeTelNo">
                <img alt="Phone" src="assets/images/phone.svg"><span
                  class="wordbreak">{{bookingMasterData.officedetails.officeTelNo}}</span>
              </li>
              <li *ngIf="bookingMasterData.officedetails.planningEmailTo">
                <img alt="Phone" src="assets/images/mail.svg"><span
                  class="red wordbreak">{{bookingMasterData.officedetails.planningEmailTo}}</span>
              </li>
            </ul>
          </div>
        </div>

      </div>

    </div>
  </div>
</ng-template>

<ng-template #deleteDraftInspection let-modal>

  <!-- <div class="modal-body">
    <div class="small-model new-padding">
      <h2 class="confirm-title"><img class="mr-2" src="assets/images/caution-red.svg" alt="">{{'COMMON.LBL_DRAFT_TITLE'
        | translate }}</h2>
      <p class="light">{{'EDIT_BOOKING.LBL_DELETE_DRAFT_CONFIRM' | translate }} </p>
      <div class="text-right">
        <button class="tertiary-cta small" (click)="cancelRemoveDraftBooking()">{{ 'COMMON.LBL_CONFIRMCANCEL' |
          translate }}</button>
        <button class="primary-cta small" (click)="deleteDraftInspectionBooking();">{{ 'COMMON.LBL_DRAFT_DELETE' |
          translate }}</button>
      </div>
    </div>
  </div> -->

  <div class="delete-popup-container">
    <div class="content">
      <img src="assets/images/new-set/delete-primary.svg" alt="">
      <div class="title-container">
        <h3>{{'EDIT_BOOKING.LBL_DRAFT_TITLE' | translate }}</h3>
        <p>{{'EDIT_BOOKING.LBL_DELETE_DRAFT_CONFIRM' | translate }}</p>
      </div>
    </div>
    <div class="text-right">
      <button class="secondary-cta link" (click)="cancelRemoveDraftBooking()">
        {{
        'COMMON.LBL_CONFIRMCANCEL' |
        translate
        }}
      </button>
      <button class="primary-cta" (click)="deleteDraftInspectionBooking();">
        {{
        'COMMON.LBL_DELETE' |
        translate
        }}
      </button>
    </div>
  </div>

</ng-template>

<ng-template #MasterContactTemplate let-modal>


  <div class="common-popup-container">
    <img src="assets/images/black-close.svg" alt="" class="close" (click)="modal.dismiss('Cross click')">

    <h3 class="title">
      <span *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.customer">
        {{ 'MASTER_CONTACT.LBL_ADD_CUSTOMER_CONTACT' | translate }}
      </span>
      <span *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.supplier">
        {{ 'MASTER_CONTACT.LBL_ADD_SUPPLIER_CONTACT' | translate }}
      </span>
      <span *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.factory">
        {{ 'MASTER_CONTACT.LBL_ADD_FACTORY_CONTACT' | translate }}
      </span>

    </h3>

    <p class="subtitle" style="padding-left:0.5%">
      <span *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.customer">
        {{bookingPreviewData.cusname }}
      </span>
      <span *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.supplier">
        {{bookingPreviewData.suppliername }}
      </span>
      <span *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.factory">
        {{bookingPreviewData.factoryname }}
      </span>

    </p>

    <div class="table-container booking-table-container mt-4 h-scroll table-max-height-400">
      <table class="pagination-table bordered">
        <thead>
          <tr>

            <th> {{ 'MASTER_CONTACT.LBL_NAME' | translate }}</th>
            <th>{{ 'MASTER_CONTACT.LBL_EMAIL' | translate }}</th>
            <th>{{ 'MASTER_CONTACT.LBL_PHONENO' | translate }}</th>
            <th></th>

          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of masterContactData.contactValidators;  let i = index">

            <td>
              <div class="my-input-group">
                <input type="text" class="width-290" [(ngModel)]="item.contact.name"
                  [ngClass]="{ 'is-invalid':!item.masterContactValidator.isValid('name')}"
                  placeholder="{{ 'MASTER_CONTACT.LBL_NAME' | translate }}">

                <div *ngIf="!item.masterContactValidator.isValid('name')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterContactValidator.getErrors('name')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>

            <td>
              <div class="my-input-group">
                <input type="text" class="width-290" [(ngModel)]="item.contact.emailId"
                  [ngClass]="{ 'is-invalid':!item.masterContactValidator.isValid('emailId')}"
                  placeholder="{{ 'MASTER_CONTACT.LBL_EMAIL' | translate }}">

                <div *ngIf="!item.masterContactValidator.isValid('emailId')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterContactValidator.getErrors('emailId')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>


            <td>
              <div class="my-input-group">
                <input type="text" class="width-290" [(ngModel)]="item.contact.phoneNo" [ngClass]="{ 'is-invalid': masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.customer
                  && !item.masterContactValidator.isValid('phoneNo')}"
                  placeholder="{{ 'MASTER_CONTACT.LBL_PHONENO' | translate }}">

                <div
                  *ngIf="masterContactData.masterContactTypeId == masterContactData.masterContactTypeEnum.customer && !item.masterContactValidator.isValid('phoneNo')"
                  class="invalid-feedback" style="display:block">
                  <div *ngFor="let error of item.masterContactValidator.getErrors('phoneNo')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>

            <td>
              <div class="my-input-group">
                <button class="secondary-cta small" (click)="removeMasterContactRow(i)">
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-2">
      <span class="advanced-search cursor-pointer" (click)="addMasterContactRow()">
        {{
        'EDIT_BOOKING.LBL_PO_POPUP_PO_NEW' | translate
        }}
      </span>
    </div>

    <div class="cta-container">
      <button class="secondary-cta link cancel" (click)="modal.dismiss('Cross click')"
        [disabled]="bookingMasterData.pageLoader">
        {{ 'EDIT_BOOKING.LBL_PO_POPUP_CANCEL' | translate }}
      </button>
      <button class="primary-cta" (click)="saveMasterContact()" [disabled]="bookingMasterData.pageLoader">
        {{ 'EDIT_BOOKING.LBL_PO_POPUP_SAVE' | translate }}
        <span *ngIf="bookingMasterData.pageLoader">
          <i class="fa fa-refresh fa-spin" aria-hidden="true"></i>
        </span>
      </button>
    </div>
  </div>





</ng-template>


<ng-template #bookingProductDeletePopup let-modal>

  <div class="delete-popup-container">
    <div class="content">
      <img src="assets/images/new-set/delete-primary.svg" alt="">
      <div class="title-container">
        <h3>{{'EDIT_BOOKING.LBL_DELETE_PO_POPUP_TITLE' | translate }}</h3>
        <p>
          {{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CONFIRM_MSG1' | translate }} <b>
            {{
            bookingMasterData.deletePoProductName
            }}
          </b>{{
          'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CONFIRM_MSG2' | translate
          }}
        </p>
      </div>
    </div>
    <div class="text-right">
      <button class="secondary-cta link" (click)="modal.dismiss('Cross click')">
        {{
        'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CANCEL' | translate
        }}
      </button>
      <button class="primary-cta" (click)="removePoProductData();">
        {{
        'EDIT_BOOKING.LBL_DELETE_PO_POPUP_OK' | translate
        }}
      </button>
    </div>
  </div>

  <!--   <div class="modal-body">
    <div class="small-model new-padding">
      <h2 class="confirm-title"><img class="mr-2" src="assets/images/caution-red.svg" alt="">{{
        'EDIT_BOOKING.LBL_DELETE_PO_POPUP_TITLE' | translate }}</h2>
      <p class="light">{{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CONFIRM_MSG1' | translate }} <b>{{
          bookingMasterData.deletePoProductName }}</b>{{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CONFIRM_MSG2' | translate }}
      </p>
      <div class="text-right">
        <button class="secondary-cta link" (click)="modal.dismiss('Cross click')">
          {{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CANCEL' | translate }}
        </button>
        <button class="primary-cta" (click)="removePoProductData();">
          {{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_OK' | translate }}
        </button>
      </div>
    </div>
  </div> -->

</ng-template>

<ng-template #bookingTemplate>

  <!--#region Booking Header Section-->
  <div class="booking-section-info-header">
    <div class="column">
      <p class="info">
        <img src="assets/images/new-set/info-dark.svg" alt="">{{
        'EDIT_BOOKING.LBL_BOOKING_NOTE' |
        translate
        }}
      </p>
    </div>
    <div class="column">
      <button class="tertiary-cta small mr-2" style="text-transform: capitalize;"
        *ngIf="!bookingMasterData.IsInternalUser" (click)="getBookingTerms()">
        <img class="mr-0" src="assets/images/new-set/tandc.svg" alt="">{{
        'EDIT_BOOKING.LBL_BOOKING_TERMS_CONDIIONS' |
        translate
        }}
      </button>
      <button class="primary-cta small" [disabled]="!this.model.customerId"
        *ngIf="!this.model.id || isReBooking || isReInspection" (click)="saveDraftInspectionBooking();">
        {{
        'EDIT_BOOKING.LBL_SAVE_DRAFT' |
        translate
        }}
      </button>
    </div>
  </div>
  <!--#endregion Booking Header Section-->
  <!--#region Booking Body Section -->
  <!--#region General Info-->
  <div class="booking-step-container"
    [ngClass]="{'active': panelNavigation.stepOne == panelNavigationStatus.Active, 'complete': panelNavigation.stepOne == panelNavigationStatus.Completed}">

    <div class="step-header step1" (click)="changeStep(1)">
      <div class="heading-container">
        <span
          *ngIf="panelNavigation.stepOne == panelNavigationStatus.Default || panelNavigation.stepOne == panelNavigationStatus.Active"
          class="step-count" [ngClass]="{'active': panelNavigation.stepOne == panelNavigationStatus.Active}">1</span>

        <img *ngIf="panelNavigation.stepOne == panelNavigationStatus.Completed"
          src="assets/images/new-set/green-circle-tick.svg" alt="">
        <h3 class="title">{{ 'EDIT_BOOKING.LBL_GENERALINFORMATION' | translate }}</h3>

        <ng-container *ngIf="panelNavigation.stepOne == panelNavigationStatus.Completed">
          <div class="selected-values-container">
            <div class="step-selected-values">
              <small>{{ 'EDIT_BOOKING.LBL_CUS' | translate }}</small>
              <p>{{bookingPreviewData.cusname | slice:0:40 }}</p>
            </div>
            <div class="step-selected-values">
              <small>{{ 'EDIT_BOOKING.LBL_SUP' | translate }}</small>
              <p>{{bookingPreviewData.suppliername | slice:0:40 }}</p>
            </div>
            <div class="step-selected-values">
              <small>{{ 'EDIT_BOOKING.LBL_FACT' | translate }}</small>
              <p>{{bookingPreviewData.factoryname | slice:0:40 }}</p>
            </div>
          </div>
        </ng-container>

      </div>
    </div>

    <div class="step-body" *ngIf="panelNavigation.stepOne == panelNavigationStatus.Active">

      <div class="new-structure">

        <!--#region First Column-->
        <div class="step-body-column">

          <!--#region Customer Details-->
          <div class="step-body-row">

            <div class="body-section-wrapper">

              <h3 class="step-section-title hover" (click)="toggleCustomerSection()">
                <img src="assets/images/new-set/booking-customer-detail.svg" alt="">{{
                'EDIT_BOOKING.LBL_CUSTOMER_DETAILS' |
                translate
                }}
              </h3>

              <div class="row">
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_CUS' | translate }}</label>
                    <ng-select #customer
                      [disabled]="isReInspection || (model.id!=0 && model.statusId != _bookingStatus.Requested)"
                      [searchable]="true" [items]="bookingMasterData.Customerlist" bindLabel="name"
                      (change)="getCusRelatedDetails($event)" [clearable]="false"
                      [loading]="bookingMasterData.Initialloading"
                      [ngClass]="{ 'is-invalid': !validator.isValid('customerId')}" bindValue="id" [hideSelected]="true"
                      placeholder="--- {{(bookingMasterData.Customerlist!=null && bookingMasterData.Customerlist.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                      [(ngModel)]="model.customerId" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div *ngIf="!validator.isValid('customerId')" class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('customerId')">{{ error | translate }}</div>
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_CUS_BOOKING_NO' | translate }}</label>
                    <input maxlength="400" [ngClass]="{ 'is-invalid': !validator.isValid('customerBookingNo')}"
                      placeholder="{{ 'EDIT_BOOKING.LBL_CUS_BOOKING_NO' | translate }}"
                      [(ngModel)]="model.customerBookingNo" type="text" />
                  </div>
                </div>

              </div>

              <div class="row" [@expandCollapse]="customerMoreSection ? 'open' : 'close'">

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2" *ngIf="model.customerId>0">
                  <div class="my-input-group">

                    <a (click)="AddContact(_userTypeId.Customer)"
                      *ngIf="(model.isBookingRequestRole || model.isBookingVerifyRole) && bookingMasterData.IsInternalUser"
                      class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_CONTACT' | translate
                      }}
                    </a>

                    <a (click)="addNewContactPopup(masterContactData.masterContactTypeEnum.customer,MasterContactTemplate)"
                      *ngIf="model.customerId && bookingMasterData.userTypeId==userTypeEnum.Customer"
                      class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_CONTACT' | translate
                      }}
                    </a>

                    <label for="">{{ 'EDIT_BOOKING.LBL_CUS_CONTACT' | translate }}</label>

                    <ng-select #customercontact [items]="bookingMasterData.customerContactList" bindLabel="contactName"
                      class="multiple" bindValue="id" [multiple]="true" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.cuscontactloading [hideSelected]="true"
                      [ngClass]="{ 'is-invalid': !validator.isValid('inspectionCustomerContactList')}"
                      placeholder="--- {{ (bookingMasterData.customerContactList!=null && bookingMasterData.customerContactList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionCustomerContactList" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.contactName }}</div>
                      </ng-template>
                    </ng-select>

                    <div *ngIf="!validator.isValid('inspectionCustomerContactList')" class="invalid-feedback"
                      style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionCustomerContactList')">
                        {{ error | translate }}
                      </div>
                    </div>

                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="(model.customerId>0  && bookingMasterData.isCustomerDeptAvailable)">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_CUS_DEPARTMENT' | translate }}</label>
                    <ng-select #customerdep [disabled]="(isReInspection) && !bookingMasterData.IsInternalUser"
                      [items]="bookingMasterData.customerDepartmentList" bindLabel="name" bindValue="id"
                      [multiple]="true" [closeOnSelect]="true" [searchable]="true" class="multiple"
                      [loading]=bookingMasterData.cusloading [hideSelected]="true"
                      (change)="getCustomerContactByBrandOrDept()"
                      [ngClass]="{ 'is-invalid': (!validator.isValid('inspectionCustomerDepartmentList') && (bookingMasterData.customerDepartmentList!=null && bookingMasterData.customerDepartmentList.length!=0))}"
                      placeholder="--- {{ (bookingMasterData.customerDepartmentList!=null && bookingMasterData.customerDepartmentList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionCustomerDepartmentList" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div
                      *ngIf="!validator.isValid('inspectionCustomerDepartmentList') && (bookingMasterData.customerDepartmentList!=null && bookingMasterData.customerDepartmentList.length!=0)"
                      class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionCustomerDepartmentList')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="(model.customerId>0 && bookingMasterData.isCustomerBrandAvailable)">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_CUS_BRAND' | translate }}</label>
                    <ng-select #customerbrand [disabled]="(isReInspection && !bookingMasterData.IsInternalUser)"
                      [items]="bookingMasterData.customerBrandList" bindLabel="name" class="multiple" bindValue="id"
                      [multiple]="true" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.cusloading [hideSelected]="true"
                      (change)="getCustomerContactByBrandOrDept()"
                      [ngClass]="{ 'is-invalid': (!validator.isValid('inspectionCustomerBrandList') && (bookingMasterData.customerBrandList!=null && bookingMasterData.customerBrandList.length!=0))}"
                      placeholder="--- {{ (bookingMasterData.customerBrandList!=null && bookingMasterData.customerBrandList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionCustomerBrandList" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div
                      *ngIf="!validator.isValid('inspectionCustomerBrandList') && (bookingMasterData.customerBrandList!=null && bookingMasterData.customerBrandList.length!=0)"
                      class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionCustomerBrandList')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>


                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="(model.customerId>0 && bookingMasterData.isCustomerBuyerAvailable)">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_BUYER' | translate }}</label>
                    <ng-select [disabled]="(isReInspection) && !bookingMasterData.IsInternalUser" [multiple]="true"
                      [closeOnSelect]="true" [searchable]="true" class="multiple"
                      [loading]="bookingMasterData.cusloading" [items]="bookingMasterData.customerBuyerList"
                      bindLabel="name" bindValue="id" [ngClass]="{ 'is-invalid': (!validator.isValid('inspectionCustomerBuyerList') && (bookingMasterData.customerBuyerList!=null
              && bookingMasterData.customerBuyerList.length!=0))}" [hideSelected]="true"
                      placeholder="--- {{ (bookingMasterData.customerBuyerList!=null && bookingMasterData.customerBuyerList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionCustomerBuyerList" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div *ngIf="!validator.isValid('inspectionCustomerBuyerList') && (bookingMasterData.customerBuyerList!=null
            && bookingMasterData.customerBuyerList.length!=0)" class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionCustomerBuyerList')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="(model.customerId>0 && bookingMasterData.isCustomerMerchandiserAvailable)">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_CUS_MERCHANDISER' | translate }}</label>
                    <ng-select [disabled]="(isReInspection) && !bookingMasterData.IsInternalUser" [multiple]="true"
                      [closeOnSelect]="true" [searchable]="true" class="multiple"
                      [loading]="bookingMasterData.cusloading" [items]="bookingMasterData.customerMerchandiserList"
                      bindLabel="name" bindValue="id" [ngClass]="{ 'is-invalid': (!validator.isValid('inspectionCustomerMerchandiserList') && (bookingMasterData.customerMerchandiserList!=null
                    && bookingMasterData.customerMerchandiserList.length!=0))}" [hideSelected]="true"
                      placeholder="--- {{ (bookingMasterData.customerMerchandiserList!=null && bookingMasterData.customerMerchandiserList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionCustomerMerchandiserList" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div *ngIf="!validator.isValid('inspectionCustomerMerchandiserList') && (bookingMasterData.customerMerchandiserList!=null
                    && bookingMasterData.customerMerchandiserList.length!=0)" class="invalid-feedback"
                      style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionCustomerMerchandiserList')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>



              </div>

            </div>


          </div>
          <!--#endregion Customer Details-->
          <!--#region Supplier Details-->
          <div class="step-body-row">
            <div class="body-section-wrapper">
              <h3 class="step-section-title">
                <img src="assets/images/new-set/booking-supplier-detail.svg" alt="">
                {{ 'EDIT_BOOKING.LBL_SUPPLIER_DETAILS' | translate }}
              </h3>
              <div class="row">
                <div class="col-12 col-md-6 col-lg-6 col-xl-4 mt-2">
                  <div class="my-input-group">
                    <a (click)="AddSupplierOrFactory(2,null,contentsupplier)"
                      *ngIf="!(model.id>0) && (bookingMasterData.IsCustomer) && bookingMasterData.showSupplierCreationLink"
                      class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_SUPPLIER' | translate
                      }}
                    </a>
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_SUP' | translate }}</label>
                    <ng-select [disabled]="isReInspection || bookingMasterData.Issupplier ||
                  (model.id!=0 && model.statusId != _bookingStatus.Requested)" [multiple]="false"
                      [closeOnSelect]="true" [searchable]="true" [clearable]="false"
                      (change)="getSupRelatedDetails($event,model.id>0?true:false)" [hideSelected]="true"
                      [loading]=bookingMasterData.supplierloading
                      [ngClass]="{ 'is-invalid': !validator.isValid('supplierId')}"
                      [items]="bookingMasterData.supplierList" bindLabel="name" bindValue="id"
                      placeholder="--- {{ (bookingMasterData.supplierList!=null && bookingMasterData.supplierList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.supplierId" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div *ngIf="!validator.isValid('supplierId')" class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('supplierId')">{{ error | translate }}</div>
                    </div>
                    <span class="simple-message blue" *ngIf="bookingPreviewData.suppliercode">
                      Code : {{
                      bookingPreviewData.suppliercode
                      }}
                    </span>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-lg-6 col-xl-8 mt-2">
                  <div class="my-input-group">
                    <a (click)="AddContact(_userTypeId.Supplier)"
                      *ngIf="model.supplierId && bookingMasterData.IsInternalUser && (model.isBookingRequestRole || model.isBookingVerifyRole)"
                      class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_CONTACT' | translate
                      }}
                    </a>

                    <a (click)="addNewContactPopup(masterContactData.masterContactTypeEnum.supplier,MasterContactTemplate)"
                      *ngIf="(bookingMasterData.userTypeId==userTypeEnum.Supplier || bookingMasterData.userTypeId==userTypeEnum.Customer) && model.supplierId && this.model.customerId"
                      class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_CONTACT' | translate
                      }}
                    </a>

                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_SUP_CONTACT' | translate }}</label>
                    <ng-select [multiple]="true" [closeOnSelect]="false" [searchable]="true"
                      [loading]=bookingMasterData.suploading class="multiple"
                      [items]="bookingMasterData.supplierContactList" bindLabel="contactName" bindValue="contactId"
                      [ngClass]="{ 'is-invalid': !validator.isValid('inspectionSupplierContactList')}"
                      [hideSelected]="true"
                      placeholder="--- {{ (bookingMasterData.supplierContactList!=null && bookingMasterData.supplierContactList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionSupplierContactList" appendTo="body">
                      <ng-template ng-label-tmp let-item="item" let-clear="clear">
                        <span class="ng-value-icon right" (click)="clear(item)">×</span>
                        <div class="text-wrap">{{item.contactName}} ({{item.contactEmail}}) / {{item.phone}}</div>
                      </ng-template>
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{item.contactName}} ({{item.contactEmail}}) / {{item.phone}}</div>
                      </ng-template>
                    </ng-select>
                    <div *ngIf="!validator.isValid('inspectionSupplierContactList')" class="invalid-feedback"
                      style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionSupplierContactList')">
                        {{ error | translate }}
                      </div>
                    </div>
                    <span class="simple-message">
                      {{
                      'EDIT_BOOKING.MSG_SUP_FACT_INSP_REPORTS' | translate
                      }}
                    </span>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-4 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_FACT_REGIONAL_PHONE' | translate }}</label>
                    <div class="d-flex">
                      <input disabled="disabled" [value]="bookingPreviewData.supplierPhoneNumber" type="text" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!--#endregion Supplier Details-->
          <!--#region Factory Details-->
          <div class="step-body-row">
            <div class="body-section-wrapper mb-0">
              <h3 class="step-section-title">
                <img src="assets/images/new-set/booking-factory-detail.svg" alt="">{{
                'EDIT_BOOKING.LBL_FACTORY_DETAILS' | translate
                }}
              </h3>
              <div class="row">

                <div class="col-12 col-md-6 col-lg-6 col-xl-4 mt-2">
                  <div class="my-input-group">
                    <a (click)="AddSupplierOrFactory(1,null,contentsupplier)"
                      *ngIf="bookingMasterData.showFactoryCreationLink"
                      class="right-link">+{{'EDIT_BOOKING.LBL_ADD_FACTORY' | translate }}</a>
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_FACT' | translate }}</label>
                    <ng-select [disabled]="_bookingIsInspected || isReInspection || bookingMasterData.IsFactory"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true" appendTo="body"
                      (change)="geFactRelatedDetails($event)" [clearable]="false"
                      [loading]=bookingMasterData.factoryloading
                      [ngClass]="{ 'is-invalid': (bookingMasterData.userTypeId != _userTypeId.Customer || (bookingMasterData.userTypeId == _userTypeId.Customer
                            && model.statusId != _bookingStatus.Requested && model.statusId != _bookingStatus.New))?!validator.isValid('factoryId'):false }"
                      [items]="bookingMasterData.factoryList" bindLabel="name" bindValue="id" [hideSelected]="true"
                      placeholder="--- {{ (bookingMasterData.factoryList!=null && bookingMasterData.factoryList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.factoryId">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                    <div
                      *ngIf="(bookingMasterData.userTypeId != _userTypeId.Customer || (bookingMasterData.userTypeId == _userTypeId.Customer
                              && model.statusId != _bookingStatus.Requested && model.statusId != _bookingStatus.New))?!validator.isValid('factoryId'):false"
                      class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('factoryId')">{{ error | translate }}</div>
                    </div>
                    <span class="simple-message blue" *ngIf="bookingPreviewData.factcode">
                      Code :
                      {{
                      bookingPreviewData.factcode
                      }}
                    </span>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-8 mt-2">
                  <div class="my-input-group">
                    <a (click)="AddContact(_userTypeId.Factory)"
                      *ngIf="model.factoryId && bookingMasterData.IsInternalUser && (model.isBookingRequestRole || model.isBookingVerifyRole)"
                      class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_CONTACT' | translate
                      }}
                    </a>

                    <a (click)="addNewContactPopup(masterContactData.masterContactTypeEnum.factory,MasterContactTemplate)"
                      *ngIf="!bookingMasterData.IsInternalUser && model.factoryId" class="right-link">
                      +{{
                      'EDIT_BOOKING.LBL_ADD_CONTACT' | translate
                      }}
                    </a>
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_FACT_CONTACT' | translate }}</label>
                    <ng-select [multiple]="true" class="multiple" [closeOnSelect]="false" [searchable]="true"
                      appendTo="body" [hideSelected]="true" [loading]=bookingMasterData.factloading
                      [ngClass]="{ 'is-invalid': (bookingMasterData.userTypeId != _userTypeId.Customer || (bookingMasterData.userTypeId == _userTypeId.Customer
                      && model.statusId != _bookingStatus.Requested && model.statusId != _bookingStatus.New))?!validator.isValid('inspectionFactoryContactList'):false}"
                      placeholder="--- {{ (bookingMasterData.factoryContactList!=null && bookingMasterData.factoryContactList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [items]="bookingMasterData.factoryContactList" bindLabel="contactName" bindValue="contactId"
                      [(ngModel)]="model.inspectionFactoryContactList">
                      <ng-template ng-label-tmp let-item="item" let-clear="clear">
                        <span class="ng-value-icon right" (click)="clear(item)">×</span>
                        <div class="text-wrap">{{item.contactName}} ({{item.contactEmail}}) / {{item.phone}}</div>
                      </ng-template>
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{item.contactName}} ({{item.contactEmail}}) / {{item.phone}}</div>
                      </ng-template>
                    </ng-select>

                    <div
                      *ngIf="(bookingMasterData.userTypeId != _userTypeId.Customer || (bookingMasterData.userTypeId == _userTypeId.Customer
                          && model.statusId != _bookingStatus.Requested && model.statusId != _bookingStatus.New))?!validator.isValid('inspectionFactoryContactList'):false"
                      class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('inspectionFactoryContactList')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-4 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_FACT_REGIONAL_PHONE' | translate }}</label>
                    <div class="d-flex">
                      <input disabled="disabled" [value]="bookingPreviewData.phoneNumber" type="text" />
                    </div>
                  </div>
                </div>
                <div class="col-lg-12" *ngIf="bookingPreviewData.factaddress || bookingPreviewData.factRegaddress">
                  <div class="factory-address">
                    <img src="assets/images/new-set/location-pin.svg" alt="">
                    <div class="address-container">
                      <p class="address-label"> {{ 'EDIT_BOOKING.LBL_FACT_ADDRESS' | translate}} </p>

                      <p class="address-value">{{ bookingPreviewData.factaddress }}</p>

                      <p class="address-label"> {{ 'EDIT_BOOKING.LBL_FACT_REGIONAL_ADDRESS' | translate }}</p>
                      <p class="address-value">{{ bookingPreviewData.factRegaddress }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!--#endregion Factory Details-->


        </div>

        <!--#endregion First Column-->
        <!--#region Second Column-->

        <div class="step-body-column last">
          <div class="step-body-row step-body-right-column">
            <div class="contact-group">
              <h4 class="column-title">{{ 'EDIT_BOOKING.LBL_APPLICANT_DETAILS' | translate }}</h4>
              <div class="user-profile">
                <img src="assets/images/new-set/profile-thumb.svg" alt="" class="thumbnail">
                <p class="name bold">{{model.applicantName}}</p>
              </div>
              <div class="contact-detail-wrapper">
                <p class="contact-detail">
                  <img src="assets/images/new-set/mail.svg" alt="">{{model.applicantEmail}}
                </p>
                <div class="contact-detail" *ngIf="true">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_APPLICANT_PH' | translate }}</label>
                    <div class="d-flex">
                      <input maxlength="200" [ngClass]="{ 'is-invalid': !validator.isValid('applicantPhoneNo')}"
                        placeholder="{{ 'EDIT_BOOKING.LBL_APPLICANT_PH' | translate }}"
                        [(ngModel)]="model.applicantPhoneNo" type="text" />
                    </div>
                    <div *ngIf="!validator.isValid('applicantPhoneNo')" class="invalid-feedback">
                      <div *ngFor="let error of validator.getErrors('applicantPhoneNo')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>
                <p class="contact-detail" *ngIf="false">
                  <img src="assets/images/new-set/phone.svg" alt="">+91 829 151 1233
                </p>
              </div>
            </div>
            <div class="contact-group" *ngIf="bookingMasterData.officedetails.officeName">
              <h4 class="column-title">Office Address</h4>
              <ng-container *ngIf="false">
                <div class="user-profile disabled">
                  <img src="assets/images/new-set/booking-factory-detail.svg" alt="" class="thumbnail">
                  <p class="name">Select Factory to see office address</p>
                </div>
              </ng-container>
              <ng-container *ngIf="true">
                <div class="user-profile">
                  <img src="assets/images/new-set/office.svg" alt="" class="thumbnail">
                  <p class="name">
                    {{bookingMasterData.officedetails.officeName}} {{bookingMasterData.officedetails.officeAddress}}
                  </p>
                </div>
                <div class="contact-detail-wrapper">
                  <p class="contact-detail">
                    <img src="assets/images/new-set/phone.svg" alt="">{{bookingMasterData.officedetails.officeTelNo}}
                  </p>
                  <p class="contact-detail">
                    <img src="assets/images/new-set/mail.svg" alt="">{{bookingMasterData.officedetails.planningEmailTo}}
                  </p>
                </div>
              </ng-container>
            </div>
          </div>
        </div>

        <!--#endregion Second Column-->

      </div>

      <div class="row mb-3 pb-1">
        <div class="col-lg-12 text-right">
          <button class="primary-cta big" (click)="bookingPanelValidate();">Next</button>
        </div>
      </div>

    </div>

  </div>

  <!--#endregion General Info-->
  <!--#region Process Info-->


  <div class="booking-step-container complete"
    [ngClass]="{'active': panelNavigation.stepTwo == panelNavigationStatus.Active, 'complete': panelNavigation.stepTwo == panelNavigationStatus.Completed}">
    <div class="step-header step2">
      <div class="heading-container">
        <span
          *ngIf="panelNavigation.stepTwo == panelNavigationStatus.Default || panelNavigation.stepTwo == panelNavigationStatus.Active"
          class="step-count" [ngClass]="{'active': panelNavigation.stepTwo == panelNavigationStatus.Active}">2</span>
        <img *ngIf="panelNavigation.stepTwo == panelNavigationStatus.Completed"
          src="assets/images/new-set/green-circle-tick.svg" alt="">
        <h3 class="title">{{ 'EDIT_BOOKING.LBL_PROCESSINFORMATION' | translate }}</h3>
        <ng-container *ngIf="panelNavigation.stepTwo == panelNavigationStatus.Completed">
          <div class="selected-values-container">
            <div class="step-selected-values">
              <small>{{ 'EDIT_BOOKING.LBL_SERVICE_DATE' | translate }}</small>
              <p>
                {{bookingPreviewData.servicefromdatepanel}}
                <span class="light">{{ 'EDIT_BOOKING.LBL_SERVICE_TO' | translate }}</span>
                {{bookingPreviewData.servicetodatepanel}}
              </p>
            </div>
            <div class="step-selected-values">
              <small>{{ 'EDIT_BOOKING.LBL_CUS_SERVICETYPE' | translate }}</small>
              <p>{{bookingPreviewData.servicetype}}</p>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
    <div class="step-body" *ngIf="panelNavigation.stepTwo == panelNavigationStatus.Active">
      <div class="new-structure">
        <div class="step-body-column">
          <div class="step-body-row">
            <div class="body-section-wrapper">
              <h3 class="step-section-title">
                <img src="assets/images/new-set/booking-dates.svg" alt="">{{
                'EDIT_BOOKING.LBL_INSP_DATE' | translate
                }}
              </h3>

              <div class="row">
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_BUSINESS_LINES' | translate }}</label>
                    <ng-select #businessLine [items]="bookingMasterData.businessLines" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                      [disabled]="this.model.id && !this.isReBooking && !this.isReInspection"
                      [loading]=bookingMasterData.businessLineLoading [hideSelected]="true"
                      [ngClass]="{ 'is-invalid': !validator.isValid('businessLine')}"
                      (change)="onChangeBusinessLines($event);" [clearable]="false"
                      placeholder="--- {{ (bookingMasterData.businessLines!=null && bookingMasterData.businessLines.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.businessLine" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="!validator.isValid('businessLine')" class="invalid-feedback" style="display:block">
                    <div *ngFor="let error of validator.getErrors('businessLine')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_CUS_SERVICETYPE' | translate }}</label>
                    <ng-select #customerservicetype [items]="bookingMasterData.customerServiceList" bindLabel="name"
                      bindValue="id" [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.customerserviceloading [hideSelected]="true"
                      (change)="onchangeServiceType($event);" [clearable]="false" [disabled]="_bookingIsInspected"
                      [ngClass]="{ 'is-invalid': !validator.isValid('serviceTypeId')}"
                      placeholder="--- {{ (bookingMasterData.customerServiceList!=null && bookingMasterData.customerServiceList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.serviceTypeId" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>

                  </div>
                  <div *ngIf="!validator.isValid('serviceTypeId')" class="invalid-feedback" style="display:block">
                    <div *ngFor="let error of validator.getErrors('serviceTypeId')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="(isReInspection || this.model.previousBookingNo) && !isReBooking">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_REINSPECTIONTYPE' | translate }}</label>
                    <ng-select #reInspection [items]="bookingMasterData.reInspectionServiceTypes" bindLabel="name"
                      bindValue="id" [multiple]="false" [closeOnSelect]="true" [searchable]="true" [clearable]="false"
                      [loading]=bookingMasterData.productsCategoryloading [hideSelected]="true"
                      [disabled]="_bookingIsInspected"
                      placeholder="--- {{ (bookingMasterData.customerServiceList!=null && bookingMasterData.customerServiceList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [ngClass]="{ 'is-invalid': !validator.isValid('reinspectionType')}"
                      [(ngModel)]="model.reinspectionType" appendTo="body">
                    </ng-select>
                  </div>
                  <div *ngIf="!validator.isValid('reinspectionType')" class="invalid-feedback" style="display:block">
                    <div *ngFor="let error of validator.getErrors('reinspectionType')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">

                    <div>

                    </div>
                    <label class="required" for="">

                      {{ 'EDIT_BOOKING.LBL_SERVICE_FROMDATE' | translate }}

                      <img class="hover" (click)="showLeadDayPopup(FactoryLeadDayPopup)"
                        src="assets/images/red-question.png" style="width: 13px;" alt="">

                    </label>

                    <!--  <a (click)="showLeadDayPopup(FactoryLeadDayPopup)">
                      <img src="assets/images/red-question.png" style="width: 13px;" alt="">
                    </a> -->

                    <div class="d-flex my-input-group">

                      <div class="calendar-wrapper inline mr-2">
                        <input type="text" container="body" [disabled]="isDateDisabled"
                          [ngClass]="{ 'is-invalid':  !validator.isValid('serviceDateFrom')}" readonly=readonly
                          [navigation]="arrow" (dateSelect)="onserviceDateFromSelection($event)"
                          [(ngModel)]="model.serviceDateFrom" [markDisabled]="isDisabled" ngbDatepicker
                          #sdf="ngbDatepicker" (click)="sdf.toggle()">
                        <img src="assets/images/calendar-icon.svg" alt="" class="calendar-icon" (click)="sdf.toggle()">
                      </div>
                      <div class="calendar-wrapper inline" *ngIf="bookingMasterData.showServiceDateTo">
                        <input type="text" container="body" [disabled]="isDateDisabled"
                          (dateSelect)="onserviceDateToSelection($event)"
                          [ngClass]="{ 'is-invalid':  !validator.isValid('serviceDateTo')}" [navigation]="arrow"
                          readonly=readonly [(ngModel)]="model.serviceDateTo" [markDisabled]="isDisabled" ngbDatepicker
                          #sdt="ngbDatepicker" (click)="sdt.toggle()">
                        <img src="assets/images/calendar-icon.svg" alt="" class="calendar-icon" (click)="sdt.toggle()">
                      </div>
                    </div>

                    <div style="width: 100%;">
                      <div style="width: 50%; word-break:break-word;float:left"
                        *ngIf="!validator.isValid('serviceDateFrom')" class="invalid-feedback">
                        <div *ngFor="let error of validator.getErrors('serviceDateFrom')">
                          {{ error | translate }}
                        </div>
                      </div>
                      <div style="width: 50%; word-break:break-word;float:right"
                        *ngIf="bookingMasterData.showServiceDateTo && !validator.isValid('serviceDateTo')"
                        class="invalid-feedback">
                        <div *ngFor="let error of validator.getErrors('serviceDateTo')">
                          {{ error | translate }}
                        </div>
                      </div>
                    </div>
                    <!-- <span class="simple-message blue">First service date : 02 Jun 2021 to 08 Jun 2021</span> -->
                  </div>
                </div>
              </div>

            </div>
          </div>

          <div class="step-body-row">
            <div class="body-section-wrapper"
              [ngClass]="{ 'bookingAdditionalFields': !(entPageFieldAccessEnum.Booking_Edit_Picking | dataFieldAccessPipe :filterEntFieldAccess) &&
                  !(entPageFieldAccessEnum.Booking_Edit_Combine | dataFieldAccessPipe :filterEntFieldAccess) &&
                  !(entPageFieldAccessEnum.Booking_Edit_First_Service_Date | dataFieldAccessPipe :filterEntFieldAccess) &&
                  !bookingMasterData.isCustomerCollectionAvailable && !bookingMasterData.isCustomerPriceCategoryAvailable  }">
              <h3 class="step-section-title">
                <img src="assets/images/new-set/booking-additional-details.svg" alt="">Additional Details
              </h3>
              <div class="row">
                <div class="col-lg-12 mt-2">
                  <div class="styled-checkbox-container inline mr-3"
                    *ngIf="(entPageFieldAccessEnum.Booking_Edit_Picking | dataFieldAccessPipe :filterEntFieldAccess)">
                    <input class="styled-checkbox" id="checkbox-PickingRequired" type="checkbox"
                      [(ngModel)]="model.isPickingRequired" [disabled]="_bookingIsInspected"
                      (change)="showPickingDetails()">
                    <label for="checkbox-PickingRequired">{{ 'EDIT_BOOKING.LBL_PICKING' | translate }}
                      <!-- <img class="hover" (mouseleave)="p.close()" (mouseenter)="p.open()" #p="ngbPopover"
                        ngbPopover="{{pickingDescription}}" src="assets/images/red-question.png" style="width: 13px;"
                        alt=""> -->
                    </label>

                    <span style="padding-left:5px;">
                      <img class="hover" (click)="showPickingDescription(pickingDescription)"
                        src="assets/images/red-question.png" style="width: 13px;" alt="">
                    </span>

                  </div>
                  <div class="styled-checkbox-container inline mr-3 mt-2 mt-sm-0"
                    *ngIf="(entPageFieldAccessEnum.Booking_Edit_Combine | dataFieldAccessPipe :filterEntFieldAccess)">
                    <input class="styled-checkbox" id="checkbox-CombineOrder" type="checkbox"
                      [(ngModel)]="model.isCombineRequired"
                      [disabled]="(model.isCombineDone && !isReBooking && !isReInspection) || _bookingIsInspected">
                    <label for="checkbox-CombineOrder">
                      {{
                      'EDIT_BOOKING.LBL_COMBINE_REQ' | translate
                      }}
                    </label>
                  </div>
                </div>
              </div>
              <div class="row marginTop25"
                *ngIf="bookingMasterData.isCustomerCollectionAvailable
                   || (entPageFieldAccessEnum.Booking_Edit_First_Service_Date | dataFieldAccessPipe :filterEntFieldAccess) || bookingMasterData.isCustomerPriceCategoryAvailable">

                <!--#region First Service Date(From & To)-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="bookingMasterData.IsInternalUser
                        && (entPageFieldAccessEnum.Booking_Edit_First_Service_Date | dataFieldAccessPipe :filterEntFieldAccess)">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_Service_FIRST_FROMDATE' | translate }}</label>
                    <div class="d-flex my-input-group">
                      <div class="calendar-wrapper inline mr-2">
                        <input type="text" container="body" [disabled]="setFirstServiceDateDisabled()" readonly=readonly
                          [ngClass]="{ 'is-invalid':  !validator.isValid('firstServiceDateFrom')}" [navigation]="arrow"
                          (dateSelect)="onFirstDateSelection($event)" [(ngModel)]="model.firstServiceDateFrom"
                          [markDisabled]="isDisabled" ngbDatepicker #sdfsf="ngbDatepicker" (click)="sdfsf.toggle()">
                        <img src="assets/images/calendar-icon.svg" alt="" class="calendar-icon"
                          (click)="sdfsf.toggle()">
                      </div>

                      <div class="calendar-wrapper inline">
                        <input type="text" container="body" [disabled]="setFirstServiceDateDisabled()"
                          [navigation]="arrow" [ngClass]="{ 'is-invalid':  !validator.isValid('firstServiceDateTo')}"
                          readonly=readonly [(ngModel)]="model.firstServiceDateTo" [markDisabled]="isDisabled"
                          ngbDatepicker #sdfst="ngbDatepicker" (click)="sdfst.toggle()">
                        <img src="assets/images/calendar-icon.svg" alt="" class="calendar-icon"
                          (click)="sdfst.toggle()">
                      </div>

                    </div>
                    <!-- <span class="simple-message blue">First service date : 02 Jun 2021 to 08 Jun 2021</span> -->
                  </div>



                  <div style="width: 100%;">
                    <div style="width: 50%; word-break:break-word;float:left"
                      *ngIf="!validator.isValid('firstServiceDateFrom')" class="invalid-feedback">
                      <div *ngFor="let error of validator.getErrors('firstServiceDateFrom')">
                        {{ error | translate }}
                      </div>
                    </div>
                    <div style="width: 50%;; word-break:break-word;;float:right;"
                      *ngIf="!validator.isValid('firstServiceDateTo')" class="invalid-feedback">
                      <div *ngFor="let error of validator.getErrors('firstServiceDateTo')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>


                </div>
                <!--#endregion First Service Date(From & To)-->
                <!--#region Collection DropDown -->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="bookingMasterData.IsInternalUser && bookingMasterData.isCustomerCollectionAvailable">

                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_COLLECTION' | translate }}</label>
                    <ng-select #customerservicetype [items]="bookingMasterData.customerCollection" bindLabel="name"
                      bindValue="id" [multiple]="false" [closeOnSelect]="true" [searchable]="true" [hideSelected]="true"
                      [(ngModel)]="model.collectionId" appendTo="body"
                      placeholder="--- {{ (bookingMasterData.customerCollection!=null && bookingMasterData.customerCollection.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [ngClass]="{ 'is-invalid':  !validator.isValid('collectionId')}">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="!validator.isValid('collectionId')" class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('collectionId')">
                      {{ error | translate }}
                    </div>
                  </div>

                </div>
                <!--#endregion Collection DropDown-->
                <!--#region PriceCategory DropDown -->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2"
                  *ngIf="bookingMasterData.IsInternalUser && bookingMasterData.isCustomerPriceCategoryAvailable">

                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_PRICE_CATEGORY' | translate }}</label>
                    <ng-select #customerpricecategory [items]="bookingMasterData.customerPriceCategory" bindLabel="name"
                      bindValue="id" [multiple]="false" [closeOnSelect]="true" [searchable]="true" [hideSelected]="true"
                      [(ngModel)]="model.priceCategoryId" appendTo="body"
                      [ngClass]="{ 'is-invalid':  !validator.isValid('priceCategoryId')}"
                      placeholder="--- {{ (bookingMasterData.customerPriceCategory!=null && bookingMasterData.customerPriceCategory.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="!validator.isValid('priceCategoryId')" class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('priceCategoryId')">
                      {{ error | translate }}
                    </div>
                  </div>

                </div>
                <!--#endregion PriceCategory DropDown-->

              </div>

              <div class="row marginTop25">

                <!--#region PriceCategory DropDown -->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2" *ngIf="bookingMasterData.IsInternalUser">

                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_BOOKING_TYPES' | translate }}</label>
                    <ng-select [items]="bookingMasterData.inspectionBookingTypes" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true" [hideSelected]="true"
                      [(ngModel)]="model.bookingType" appendTo="body"
                      [ngClass]="{ 'is-invalid':  model.customerId == _customerEnum.Gap && !validator.isValid('bookingType')}"
                      placeholder="--- {{ (bookingMasterData.inspectionBookingTypes!=null && bookingMasterData.inspectionBookingTypes.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="model.customerId == _customerEnum.Gap && !validator.isValid('bookingType')"
                    class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('bookingType')">
                      {{ error | translate }}
                    </div>
                  </div>

                </div>
                <!--#endregion PriceCategory DropDown-->
                <!--#region PriceCategory DropDown -->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2" *ngIf="model.customerId == _customerEnum.Gap">

                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_PAYMENT_OPTIONS' | translate }}</label>
                    <ng-select [items]="bookingMasterData.inspectionPaymentOptions" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true" [hideSelected]="true"
                      [(ngModel)]="model.paymentOptions" appendTo="body"
                      [ngClass]="{ 'is-invalid':  model.customerId == _customerEnum.Gap && !validator.isValid('paymentOptions')}"
                      placeholder="--- {{ (bookingMasterData.inspectionPaymentOptions!=null && bookingMasterData.inspectionPaymentOptions.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="!validator.isValid('paymentOptions')" class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('paymentOptions')">
                      {{ error | translate }}
                    </div>
                  </div>

                </div>
                <!--#endregion PriceCategory DropDown-->

                <div class="col-sm-3 col-md-3 col-lg-3" style="padding-top: 0.5%"
                  *ngIf="model.paymentOptions==_paymentOptions.A">

                  <button [disabled]="searchpoloader" id="btnsearch" style="float: left !important;"
                    class="primary-cta float-right mt-3" (click)="selectFiles(_fileAttachmentCategory.Gap)">
                    Upload GAP Support Document
                    <span *ngIf="searchpoloader">
                      <i class="fa fa-refresh fa-spin" aria-hidden="true"></i>
                    </span>
                  </button>

                </div>

                <div class="col-sm-3 col-md-3 col-lg-3" *ngIf="model.paymentOptions==_paymentOptions.A">

                  <div class="file-attachment-container"
                    *ngIf="bookingMasterData.gapFileAttachments != null && bookingMasterData.gapFileAttachments.length>0">
                    <h6 class="files-count" *ngIf="bookingMasterData.gapFileAttachments.length>0">
                      {{
                      bookingMasterData.gapFileAttachments.length
                      }} Files uploaded
                    </h6>

                    <div class="file-attached-container">

                      <ng-container *ngFor="let file of bookingMasterData.gapFileAttachments; let j = index">

                        <div class="attachment">
                          <div class="cursorPointer" (click)="getFile(file)" (mouseleave)="p.close()"
                            (mouseenter)="p.open()" #p="ngbPopover" ngbPopover="{{file.fileDescription}}">
                            <img [src]="getImageIcon(file)">
                            <span class="file-name">{{file.fileName}}</span>
                          </div>
                          <img src="assets/images/new-set/close.svg" class="close-icon"
                            (click)="removeGapFileAttachment(j)">
                        </div>
                      </ng-container>


                    </div>

                  </div>

                </div>



              </div>

              <div class="row marginTop25" *ngIf="model.customerId == _customerEnum.Gap">

                <div class="col-12 col-md-6 col-lg-3">

                  <div class="my-input-group">
                    <label class="required" for="">{{ 'EDIT_BOOKING.LBL_DA_CORELATION' | translate }}</label>
                    <ng-select [items]="bookingMasterData.daCorrelationList" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true" [hideSelected]="true"
                      [(ngModel)]="model.daCorrelationId" appendTo="body" (change)="changeDACorrelation()"
                      [ngClass]="{ 'is-invalid':  model.customerId == _customerEnum.Gap ?!validator.isValid('daCorrelationId'):false}"
                      placeholder="--- {{ (bookingMasterData.daCorrelationList!=null && bookingMasterData.daCorrelationList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="model.customerId == _customerEnum.Gap ? !validator.isValid('daCorrelationId'):false"
                    class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('daCorrelationId')">
                      {{ error | translate }}
                    </div>
                  </div>

                </div>

                <div class="col-12 col-md-6 col-lg-3"
                  *ngIf="model.daCorrelationId==bookingMasterData.daCorrelationEnum.yes">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_DA_NAME' | translate }}</label>
                    <input maxlength="400" [(ngModel)]="model.gapDAName" type="text" [ngClass]="{ 'is-invalid':  model.customerId == _customerEnum.Gap
                                      && model.daCorrelationId==bookingMasterData.daCorrelationEnum.yes?
                                       !validator.isValid('gapDAName'):false}" />
                  </div>
                  <div *ngIf="model.customerId == _customerEnum.Gap
                                && model.daCorrelationId==bookingMasterData.daCorrelationEnum.yes?
                                !validator.isValid('gapDAName'):false" class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('gapDAName')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>

                <div class="col-12 col-md-6 col-lg-3"
                  *ngIf="model.daCorrelationId==bookingMasterData.daCorrelationEnum.yes">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_DA_EMAIL' | translate }}</label>
                    <input maxlength="400" [(ngModel)]="model.gapDAEmail" type="text" [ngClass]="{ 'is-invalid':  model.customerId == _customerEnum.Gap
                    && model.daCorrelationId==bookingMasterData.daCorrelationEnum.yes?
                    !validator.isValid('gapDAEmail'):false}" />
                  </div>
                  <div *ngIf="model.customerId == _customerEnum.Gap
                                && model.daCorrelationId==bookingMasterData.daCorrelationEnum.yes?
                                !validator.isValid('gapDAEmail'):false" class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('gapDAEmail')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>

              </div>

            </div>

            <div class="body-section-wrapper" [ngClass]="{ 'bookingAdditionalFieldsPaddingTop':  !bookingMasterData.isCustomerCollectionAvailable
             && !bookingMasterData.isCustomerPriceCategoryAvailable  }"
              *ngIf="model.businessLine==_businessLine.SoftLine">
              <!--#region Proccess Information Third Row-->
              <div class="row">

                <!--#region Customer Product Category DropDown-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_CUSTOMER_PRODUCT_CATEGORY' | translate }}</label>
                    <ng-select [items]="bookingMasterData.customerProductCategories" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.customerProductCategoryLoading [hideSelected]="true"
                      [clearable]="false"
                      placeholder="--- {{ (bookingMasterData.customerProductCategories!=null && bookingMasterData.customerProductCategories.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.cuProductCategory" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
                <!--#endregion Customer Product Category DropDown-->
                <!--#region Inspection Location DropDown-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_INSP_LOCATION' | translate }}</label>
                    <ng-select [items]="bookingMasterData.InspectionLocationList" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.inspectionLocationLoading [hideSelected]="true" [clearable]="false"
                      placeholder="--- {{ (bookingMasterData.InspectionLocationList!=null && bookingMasterData.InspectionLocationList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.inspectionLocation" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
                <!--#endregion Inspection Location DropDown-->
                <!--#region Season DropDown-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_SEASON' | translate }}</label>
                    <ng-select [items]="bookingMasterData.customerSeasonConfigList" bindLabel="name" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.customerConfigLoading [hideSelected]="true" [clearable]="false"
                      placeholder="--- {{ (bookingMasterData.customerSeasonConfigList!=null && bookingMasterData.customerSeasonConfigList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [ngClass]="{ 'is-invalid':model.businessLine==_businessLine.SoftLine? !validator.isValid('seasonId'):false}"
                      [(ngModel)]="model.seasonId" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="model.businessLine==_businessLine.SoftLine?!validator.isValid('seasonId'):false"
                    class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('seasonId')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>
                <!--#endregion Season DropDown-->
                <!--#region Season Year DropDown-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_SEASON_YEAR' | translate }}</label>
                    <ng-select [items]="bookingMasterData.Seasonyearlist" bindLabel="year" bindValue="id"
                      [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.customerConfigLoading [hideSelected]="true" [clearable]="false"
                      [ngClass]="{ 'is-invalid':model.businessLine==_businessLine.SoftLine? !validator.isValid('seasonYearId'):false}"
                      placeholder="--- {{ (bookingMasterData.Seasonyearlist!=null && bookingMasterData.Seasonyearlist.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.seasonYearId" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.year }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                  <div *ngIf="model.businessLine==_businessLine.SoftLine?!validator.isValid('seasonYearId'):false"
                    class="invalid-feedback">
                    <div *ngFor="let error of validator.getErrors('seasonYearId')">
                      {{ error | translate }}
                    </div>
                  </div>
                </div>
                <!--#endregion Season DropDown-->

              </div>
              <!--#endregion Proccess Information Third Row-->
              <!--#region Proccess Information Fourth Row-->
              <div class="row">

                <!--#region Shipment Types DropDown-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_SHIPMENT_TYPES' | translate }}</label>
                    <ng-select [items]="bookingMasterData.inspectionShipmentTypes" bindLabel="name" class="multiple"
                      bindValue="id" [multiple]="true" [closeOnSelect]="true" [searchable]="true"
                      [loading]=bookingMasterData.customerConfigLoading [hideSelected]="true" [clearable]="false"
                      placeholder="--- {{ (bookingMasterData.inspectionShipmentTypes!=null && bookingMasterData.inspectionShipmentTypes.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---"
                      [(ngModel)]="model.shipmentTypeIds" appendTo="body">
                      <ng-template ng-option-tmp let-item="item">
                        <div class="text-wrap">{{ item.name }}</div>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
                <!--#endregion Shipment Types DropDown-->
                <!--#region Shipment Port TextBox-->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_SHIPMENT_PORT' | translate }}</label>
                    <input maxlength="400" [(ngModel)]="model.shipmentPort" type="text" />
                  </div>
                </div>
                <!--#endregion Shipment Port TextBox-->
                <!--#region Shipment Date-->
                <!--   <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_SHIPMENT_DATE' | translate }}</label>
                    <div class="calendar-wrapper">
                      <input type="text" container="body" readonly=readonly [navigation]="arrow"
                        [(ngModel)]="model.shipmentDate" ngbDatepicker #shpd="ngbDatepicker" (click)="shpd.toggle()">
                      <img src="assets/images/calendar-icon.svg" alt="" class="calendar-icon" (click)="shpd.toggle()">
                    </div>
                  </div>
                </div> -->
                <!--#endregion Shipment Date-->
                <!--#region Ean TextBox-->
                <!--  <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_EAN' | translate }}</label>
                    <input maxlength="400" [(ngModel)]="model.ean" type="text" />
                  </div>
                </div> -->
                <!--#endregion-->

              </div>
              <!--#endregion Proccess Information Fourth Row-->
            </div>

            <div class="body-section-wrapper" *ngIf="isContainerService">
              <div class="row">

                <!--#region Container Limit -->
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label>{{'EDIT_BOOKING.EDIT_CONTAINER_LIMIT' | translate }}</label>
                    <div class="calendar-wrapper">
                      <input [(ngModel)]="model.containerLimit" type="number"
                        (change)="SetContainerLimit($event.target.value)"
                        [ngClass]="{ 'is-invalid':  !validator.isValid('containerLimit')}" min="0" max="999">
                    </div>
                    <div *ngIf="!validator.isValid('containerLimit')" class="invalid-feedback">
                      <div *ngFor="let error of validator.getErrors('containerLimit')">
                        {{ error | translate }}
                      </div>
                    </div>
                  </div>
                </div>
                <!--#endregion Container Limit -->


              </div>
            </div>


            <div class="body-section-wrapper" *ngIf="dynamicControls.length>0">
              <app-dynamic-form [dynamicControls]="dynamicControls" [dynamicControlBaseData]="dynamicControlBaseData">
              </app-dynamic-form>
            </div>

          </div>

          <div class="step-body-row">
            <div class="body-section-wrapper">
              <h3 class="step-section-title"><img src="assets/images/new-set/booking-order.svg" alt="">Orders</h3>

              <div class="common-field-container" [@expandCollapse]="commonFields ? 'open' : 'close'">
                <div class="row">
                  <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                    <div class="my-input-group">
                      <label for="">{{ 'EDIT_BOOKING.LBL_SEARCH_PO_LIST' | translate }}</label>

                      <ng-select [searchable]="true" [items]="bookingMasterData.searchPoList" bindLabel="name"
                        [loading]="bookingMasterData.searchPoLoading" (change)="changeSearchPOList($event)"
                        bindValue="id" [hideSelected]="true" appendTo="body" [virtualScroll]="true"
                        (scrollToEnd)="getSearchPoListData(true)" [typeahead]="bookingMasterData.poListInput"
                        [minTermLength]="2"
                        placeholder="--- {{(bookingMasterData.searchPoList && bookingMasterData.searchPoList.length!=0? 'BOOKING_SUMMARY.LBL_SELECT':'BOOKING_SUMMARY.MSG_NO_DATA')  | translate }} ---"
                        [(ngModel)]="bookingMasterData.searchPoId">

                        <ng-template ng-option-tmp let-item="item">
                          <div class="text-wrap">{{ item.name }}</div>
                        </ng-template>

                      </ng-select>

                    </div>
                  </div>
                  <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                    <button [disabled]="searchpoloader" id="btnsearch" style="float: left !important;"
                      class="primary-cta float-right mt-3" (click)="searchPOProducts(searchPOProductList)">
                      {{ 'EDIT_BOOKING.LBL_SEARCH_PO_SRCH_BTN' | translate }}
                      <span *ngIf="searchpoloader">
                        <i class="fa fa-refresh fa-spin" aria-hidden="true"></i>
                      </span>
                    </button>
                  </div>
                </div>
              </div>

              <div class="record-count pl-0 pr-0 align-items-end">
                <div
                  class="column d-flex align-items-xl-center flex-sm-column flex-xl-row inspection-table-badge-wrapper">
                  <p class="count mr-2">{{ 'EDIT_BOOKING.MSG_SELECT_PO' | translate }}</p>
                  <div class="inspection-table-badge-container">
                    <div class="inspection-badge" *ngIf="bookingMasterData.totalBookingQty">
                      {{ 'EDIT_BOOKING.LBL_TOTAL_BOOKINGQTY' | translate }} {{
                      'EDIT_BOOKING.LBL_TOTAL_QTY' |
                      translate
                      }}
                      <span>{{bookingMasterData.totalBookingQty}}</span>
                    </div>
                    <div class="inspection-badge" *ngIf="bookingMasterData.totalProducts">
                      <p>
                        {{ 'EDIT_BOOKING.LBL_TOTAL' | translate }} {{ 'EDIT_BOOKING.LBL_PRODUCTS' | translate }}
                        <span>{{bookingMasterData.totalProducts}}</span>
                      </p>
                    </div>
                    <div class="inspection-badge" *ngIf="bookingMasterData.totalPickingQty">
                      {{ 'EDIT_BOOKING.LBL_TOTAL_PICKINGQTY' | translate }} {{
                      'EDIT_BOOKING.LBL_TOTAL_QTY' |
                      translate
                      }}

                      <span>{{bookingMasterData.totalPickingQty}}</span>
                    </div>
                  </div>

                  <button id="btnsearch" *ngIf="bookingMasterData.selectedPOList.length>0" class="primary-cta x-small"
                    style="font-size:12px;" (click)="deletePO(deletePoList)">
                    {{ 'EDIT_BOOKING.LBL_DELETE_PO' | translate }}
                  </button>

                  <button *ngIf="!_bookingIsInspected" id="btnsearch" class="secondary-cta x-small-new mr-2"
                    style="font-size:12px;" (click)="importBulkPurchaseOrder(importBulkPurchaseOrders)">
                    Import Orders
                  </button>

                </div>

                <div class="column text-right">



                  <div class="advanced-search cursor-pointer" (click)="toggleCommonFields()"
                    *ngIf="!_bookingIsInspected">

                    <ng-container *ngIf="commonFields">
                      <img src="assets/images/new-set/minus.svg" alt="">
                    </ng-container>
                    <ng-container *ngIf="!commonFields">
                      <img src="assets/images/new-set/plus.svg" alt="">
                    </ng-container> {{ 'EDIT_BOOKING.LBL_FILL_COMMON_FIELD' | translate }}
                  </div>



                </div>
              </div>
              <div class="record-count pl-0 pr-0 align-items-end">

              </div>


              <div
                class="table-container expanded-table booking-table-container booking-product-table-container h-scroll table-max-height-550">
                <table class="pagination-table has-small-forms bordered collapsed-table">
                  <thead>
                    <tr class="sticky-top-row">
                      <!-- <th></th> -->
                      <th *ngIf="!_bookingIsInspected" class="table-action common-tooltip bottom"
                        data-tooltip="Common Filter" (click)="togglePoProductCommon()">
                        <span class=" white-badge">
                          <img src="assets/images/new-set/report-edit.svg" alt="">
                        </span>
                      </th>
                      <th>
                        {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_PONO' |
                        translate
                        }}
                      </th>
                      <!-- <th></th> -->
                      <th></th>
                      <th class="sticky-left-column">{{ 'EDIT_BOOKING.LBL_PO_PRD_REFERENCE' | translate }}</th>

                      <th></th>

                      <th>{{ 'EDIT_BOOKING.LBL_PO_PRD_REFERENCE_DESC' | translate }}</th>

                      <th
                        *ngIf="!isReInspection && (entPageFieldAccessEnum.Booking_Edit_POQuantity | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_PO_QTY' | translate }}
                      </th>
                      <th>
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_BOOKING_QTY' | translate }}
                      </th>
                      <th *ngIf="bookingMasterData.isPicking">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_PICKING_QTY' | translate }}
                        <!-- {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_QUANTITY' |
                        translate
                        }} -->
                      </th>

                      <th>{{'EDIT_BOOKING.LBL_PO_PRODUCT_ETD' | translate }}</th>

                      <th>{{'EDIT_BOOKING.LBL_PO_PRODUCT_DESTINATION_COUNTRY' | translate }}</th>

                      <th *ngIf="model.businessLine==_businessLine.SoftLine">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_COLOR_CODE' | translate }}
                      </th>
                      <th *ngIf="model.businessLine==_businessLine.SoftLine">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_COLOR_NAME' | translate }}
                      </th>

                      <th *ngIf="isContainerService">{{'EDIT_BOOKING.LBL_PO_PRODUCT_CONTAINER' | translate }}</th>

                      <th *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                      || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_AQL' |
                        translate
                        }}
                      </th>

                      <th *ngIf="!isContainerService && bookingMasterData.isCustomAqlSelected && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                            || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_SAM_TYPE' | translate }}
                      </th>

                      <th *ngIf="!isContainerService && bookingMasterData.isCustomAqlSelected && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                        || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_SAM_SIZE' | translate }}
                      </th>

                      <th *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                            || bookingMasterData.userTypeId==userTypeEnum.Customer)" class="common-tooltip bottom"
                        data-tooltip="Critical">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_CR' | translate }}
                      </th>
                      <th *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                            || bookingMasterData.userTypeId==userTypeEnum.Customer)" class="common-tooltip bottom"
                        data-tooltip="Major">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_MJ' | translate }}
                      </th>
                      <th *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                            || bookingMasterData.userTypeId==userTypeEnum.Customer)" class="common-tooltip bottom"
                        data-tooltip="Minor">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_MI' | translate }}
                      </th>


                      <th>{{'EDIT_BOOKING.LBL_Unit' | translate }}</th>

                      <th>{{'EDIT_BOOKING.LBL_PO_PRODUCT_UNIT_COUNT' | translate }}</th>



                      <th
                        *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_Barcode | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_BARCODE' |
                        translate
                        }}
                      </th>


                      <th
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_Factory_Reference | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_FACTORY_REF' | translate }}
                      </th>

                      <th *ngIf="!isContainerService">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_CATEGORY_MAIN' | translate }}
                      </th>
                      <th *ngIf="!isContainerService">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_CATEGORY_SUB' | translate }}
                      </th>
                      <th
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_SubCategory2 | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_CATEGORY_SUB2' | translate }}
                      </th>

                      <th *ngIf="bookingMasterData.IsInternalUser && !isContainerService">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_CATEGORY_SUB3' | translate }}
                      </th>

                      <th
                        *ngIf="(entPageFieldAccessEnum.Booking_Edit_CustomerRefPo | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_PO_PRODUCT_CUST_REF_PO' | translate }}
                      </th>

                      <th>{{'EDIT_BOOKING.LBL_PO_PRODUCT_REMARKS' | translate }}</th>
                      <th *ngIf="model.businessLine==_businessLine.SoftLine && bookingMasterData.IsInternalUser">
                        {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_AS_RECEIVED' |
                        translate
                        }}
                      </th>
                      <th *ngIf="model.businessLine==_businessLine.SoftLine && bookingMasterData.IsInternalUser">
                        {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_TF_RECEIVED' |
                        translate
                        }}
                      </th>
                      <th *ngIf="bookingMasterData.IsInternalUser">
                        {{
                        'EDIT_BOOKING.LBL_PO_PRODUCT_FB_TEMPLATE' | translate
                        }}
                      </th>
                      <th
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayChild | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_DISPLAY_CHILD' | translate }}
                      </th>
                      <th
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayMaster | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_ISDISPLAY' | translate }}
                      </th>
                      <th
                        *ngIf="!isContainerService && bookingMasterData.IsInternalUser && (entPageFieldAccessEnum.Booking_Edit_EcoPack | dataFieldAccessPipe :filterEntFieldAccess)">
                        {{'EDIT_BOOKING.LBL_ISECOPACK' | translate }}
                      </th>

                      <th></th>
                    </tr>
                  </thead>
                  <tbody>

                    <tr class="new-row" *ngIf="poProductCommonData">
                      <!-- <td></td> -->

                      <td *ngIf="!_bookingIsInspected"></td>

                      <td></td>

                      <td></td>

                      <td class="sticky-left-column"></td>


                      <td></td>

                      <td></td>

                      <td
                        *ngIf="!isReInspection && (entPageFieldAccessEnum.Booking_Edit_POQuantity | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>

                      <td></td>

                      <td *ngIf="bookingMasterData.isPicking">
                      </td>

                      <td>
                        <div class="my-input-group">
                          <div class="calendar-wrapper">
                            <input type="text" readonly="readonly" maxlength="10"
                              [(ngModel)]="bookingMasterData.parentEtd" class="width-160" maxlength="300"
                              (dateSelect)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.ETD)"
                              placeholder="{{ 'EDIT_PURCHASEORDER.LBL_ETD' | translate }}" (click)="ld.toggle()"
                              container='body' ngbDatepicker #ld="ngbDatepicker">
                            <img *ngIf="bookingMasterData.parentEtd" src="assets/images/cta-close-grey.svg"
                              (click)="clearETD()" alt="" class="close-icon">
                            <img src="assets/images/new-set/calendar.svg" alt="" class="calendar-icon"
                              (click)="ld.toggle()">
                          </div>
                        </div>
                      </td>

                      <td>
                        <div class="my-input-group">
                          <ng-select [items]="destinationCountryList" [multiple]="false" [closeOnSelect]="true"
                            [searchable]="true" class="width-160" bindLabel="countryName" bindValue="id"
                            [loading]="initialLoading" appendTo="body" [clearable]="false"
                            [(ngModel)]="bookingMasterData.parentDestinationCountryId"
                            (change)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.DestinationCountry)"
                            placeholder="--- {{ 'PURCHASEORDER_SUMMARY.LBL_SELECT' | translate }} ---">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.countryName }}</div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </td>

                      <td *ngIf="model.businessLine==_businessLine.SoftLine">
                      </td>

                      <td *ngIf="model.businessLine==_businessLine.SoftLine">
                      </td>

                      <td *ngIf="isContainerService">
                        <div class="my-input-group">
                          <ng-select [items]="containerList" [multiple]="false" [closeOnSelect]="true"
                            [searchable]="true" bindLabel="name" bindValue="id" [loading]="initialLoading"
                            appendTo="body" [clearable]="false" (change)="changeParentContainer($event)"
                            [(ngModel)]="bookingMasterData.parentContainerId" class="width-180" class="width-180"
                            placeholder="--- {{ 'PURCHASEORDER_SUMMARY.LBL_SELECT' | translate }} ---">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.name }}</div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </td>

                      <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                              || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        <div class="my-input-group">
                          <ng-select [items]="bookingMasterData.bookingProductAqlList" [multiple]="false"
                            [searchable]="false" bindLabel="value" bindValue="id" appendTo="body" class="width-100"
                            [clearable]="false" (change)="changeParentAql($event)"
                            placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                            [(ngModel)]="bookingMasterData.parentAql"></ng-select>
                        </div>
                      </td>

                      <td
                        *ngIf="!isContainerService && bookingMasterData.isCustomAqlSelected &&
                            (bookingMasterData.userTypeId==userTypeEnum.InternalUser || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                      </td>

                      <td
                        *ngIf="!isContainerService && bookingMasterData.isCustomAqlSelected &&
                            (bookingMasterData.userTypeId==userTypeEnum.InternalUser || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                      </td>

                      <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        <div class="my-input-group">
                          <ng-select [items]="bookingMasterData.bookingProductPickList" [multiple]="false"
                            [closeOnSelect]="true" bindLabel="value" bindValue="id" appendTo="body" class="width-80"
                            placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                            (change)="changeParentCritical($event)" [(ngModel)]="bookingMasterData.critical"
                            [clearable]="false"></ng-select>
                        </div>
                      </td>

                      <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                              || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        <ng-select [items]="bookingMasterData.bookingProductPickList" [multiple]="false"
                          [closeOnSelect]="true" bindLabel="value" bindValue="id" appendTo="body" class="width-80"
                          placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                          (change)="changeParentMajor($event)" [(ngModel)]="bookingMasterData.major"
                          [clearable]="false">
                        </ng-select>
                      </td>

                      <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                  || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                        <ng-select [items]="bookingMasterData.bookingProductPickList" [multiple]="false"
                          [closeOnSelect]="true" bindLabel="value" bindValue="id" appendTo="body" class="width-80"
                          placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                          (change)="changeParentMinor($event)" [(ngModel)]="bookingMasterData.minor"
                          [clearable]="false">
                        </ng-select>
                      </td>

                      <td></td>

                      <td> </td>

                      <td
                        *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_Barcode | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>

                      <td
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_Factory_Reference | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>

                      <td *ngIf="!isContainerService">
                        <div class="my-input-group">
                          <ng-select [items]="bookingMasterData.bookingProductCategoryList" [multiple]="false"
                            [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                            [loading]="initialLoading" appendTo="body"
                            (change)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.ProductCategory)"
                            [clearable]="false" class="width-180"
                            placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                            [(ngModel)]="bookingMasterData.parentProductCategoryId">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.name }}</div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </td>

                      <td *ngIf="!isContainerService">
                        <div class="my-input-group">
                          <ng-select [items]="bookingMasterData.bookingParentSubProductCategoryList" [multiple]="false"
                            [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                            [clearable]="false" [loading]="productSubLoading"
                            [(ngModel)]="bookingMasterData.parentProductSubCategoryId"
                            placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                            class="width-180"
                            (change)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.ProductSubCategory)"
                            appendTo="body">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.name }}</div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </td>

                      <td
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_SubCategory2 | dataFieldAccessPipe :filterEntFieldAccess)">
                        <div class="my-input-group">
                          <ng-select [items]="bookingMasterData.bookingSub2ProductCategoryList" [multiple]="false"
                            [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                            [loading]="bookingMasterData.productCategorySub2Loading" class="width-180"
                            placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                            (change)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.ProductSubCategory2)"
                            [clearable]="false" [(ngModel)]="bookingMasterData.parentProductCategorySub2Id"
                            appendTo="body">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.name }}</div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </td>

                      <td *ngIf="!isContainerService && bookingMasterData.IsInternalUser">
                        <div class="my-input-group">

                          <ng-select [items]="bookingMasterData.bookingSub3ProductCategoryList" [multiple]="false"
                            [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                            [loading]="bookingMasterData.productCategorySub2Loading" class="width-180"
                            placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                            (change)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.ProductSubCategory3)"
                            [clearable]="false" [(ngModel)]="bookingMasterData.parentProductCategorySub3Id"
                            appendTo="body">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.name }}</div>
                            </ng-template>
                          </ng-select>

                        </div>
                      </td>

                      <td
                        *ngIf="(entPageFieldAccessEnum.Booking_Edit_CustomerRefPo | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>


                      <td></td>


                      <td *ngIf="model.businessLine==_businessLine.SoftLine && bookingMasterData.IsInternalUser">
                      </td>

                      <td *ngIf="model.businessLine==_businessLine.SoftLine && bookingMasterData.IsInternalUser">
                      </td>

                      <td *ngIf="bookingMasterData.IsInternalUser">
                        <div class="my-input-group">
                          <ng-select #customerservicetype [items]="bookingMasterData.fbTemplateList" bindLabel="name"
                            bindValue="id" [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                            class="width-160" [hideSelected]="true" [(ngModel)]="bookingMasterData.parentFbTemplateId"
                            appendTo="body"
                            (change)="changeCommonField($event,CommonFieldPopUp,_commonFieldTypeEnum.FBTemplate)"
                            placeholder="--- {{ (bookingMasterData.fbTemplateList!=null
                          && bookingMasterData.fbTemplateList.length!=0?
                          'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---">
                            <ng-template ng-option-tmp let-item="item">
                              <div class="text-wrap">{{ item.name }}</div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </td>

                      <td
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayChild | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>
                      <td
                        *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayMaster | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>
                      <td
                        *ngIf="!isContainerService && bookingMasterData.IsInternalUser && (entPageFieldAccessEnum.Booking_Edit_EcoPack | dataFieldAccessPipe :filterEntFieldAccess)">
                      </td>
                      <td></td>

                    </tr>

                    <ng-template ngFor let-item [ngForOf]="bookingMasterData.bookingPOProductValidators" let-i="index">

                      <tr *ngIf="item.poProductDetail.isVisible"
                        [ngClass]="{ 'selected': item.poProductDetail.togglePicking}">

                        <!-- <td class="width40 text-center">
                          <span class="expandable-trigger" (click)=toggleExpandBooking($event,i,item)>+</span>
                        </td> -->

                        <td *ngIf="!_bookingIsInspected">

                          <span class="table-action common-tooltip-table" data-tooltip="Copy"
                            (click)="copyToBookingProducts(item.poProductDetail)">
                            <img src="assets/images/new-set/combine.svg" alt="">
                          </span>

                          <span class="table-action common-tooltip-table" data-tooltip="Delete"
                            (click)="removeBookingPoProducts(i,bookingProductDeletePopup)">
                            <img src="assets/images/new-set/delete.svg" alt="">
                          </span>

                          <span class="table-action common-tooltip-table" data-tooltip="Upload Image"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup && !_bookingIsInspected"
                            (click)="selectProductFiles(item.poProductDetail)">
                            <img src="assets/images/new-set/upload.svg" alt="">
                          </span>

                        </td>

                        <td>
                          <div class="my-input-group">
                            <ng-select class="width-180" [searchable]="true" [items]="item.poProductDetail.poList"
                              bindLabel="name" (clear)="clearPoNumber(item)" (change)="changePoNumber(item,$event)"
                              [loading]="item.poProductDetail.poLoading" bindValue="id" [hideSelected]="true"
                              appendTo="body" [virtualScroll]="true" (scrollToEnd)="getPoListData(true,item)"
                              [typeahead]="item.poProductDetail.poListInput" [minTermLength]="2"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('poId')}"
                              [disabled]="_bookingIsInspected"
                              placeholder="--- {{(item.poProductDetail.poList!=null && item.poProductDetail.poList.length!=0? 'BOOKING_SUMMARY.LBL_SELECT':'BOOKING_SUMMARY.MSG_NO_DATA')  | translate }} ---"
                              [(ngModel)]="item.poProductDetail.poId" addTagText="Add new po"
                              [addTag]="addNewPoData.bind(this)">

                              <!-- <ng-template ng-header-tmp>
                                <a style="font-size: 12px;font-weight: bold;color: #cd2d2f !important;"
                                  (click)="openPurchaseOrderPopup(AddPoProductPopUp,false,item)">
                                  {{
                                  'EDIT_BOOKING.LBL_PO_PRODUCT_PO_NO'
                                  | translate
                                  }}
                                </a>
                              </ng-template> -->

                              <ng-template ng-option-tmp let-item="item">
                                <div class="text-wrap">{{ item.name }}</div>
                              </ng-template>

                            </ng-select>

                          </div>
                          <div *ngIf="!item.validator.isValid('poId')" class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('poId')">
                              {{ error | translate }}
                            </div>
                          </div>

                        </td>

                        <td>
                          <div *ngIf="item.poProductDetail.isNewProduct" style="margin-top:5%">
                            <img src="assets/images/new.svg" alt="">
                          </div>
                        </td>

                        <td class="sticky-left-column">
                          <div class="my-input-group">
                            <ng-select class="width-180" [searchable]="true"
                              [items]="item.poProductDetail.poProductList" bindLabel="name"
                              (ngModelChange)="onProductModelChange($event,item)" (change)="changeProductData()"
                              [loading]="item.poProductDetail.poProductLoading" (clear)="clearProduct(item)"
                              bindValue="id" appendTo="body" [virtualScroll]="true"
                              (scrollToEnd)="getPoProductListData(item,true)" [disabled]="_bookingIsInspected"
                              [typeahead]="item.poProductDetail.poProductListInput" [minTermLength]="2"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('productId')}"
                              placeholder="--- {{(item.poProductDetail.poProductList!=null && item.poProductDetail.poProductList.length!=0? 'BOOKING_SUMMARY.LBL_SELECT':'BOOKING_SUMMARY.MSG_NO_DATA')  | translate }} ---"
                              [(ngModel)]="item.poProductDetail.productId">

                              <ng-template ng-header-tmp>
                                <a class="right-link"
                                  style="font-size: 12px;font-weight: bold;color: #cd2d2f !important;"
                                  (click)="openCustomerProductPopup(AddPoProductPopUp,i)">
                                  {{
                                  'EDIT_BOOKING.LBL_PO_PRODUCT_PRD_NO'
                                  | translate
                                  }}
                                </a>
                              </ng-template>

                              <ng-template ng-option-tmp let-item="item">
                                <div class="text-wrap">{{ item.name }}</div>
                              </ng-template>
                            </ng-select>

                          </div>
                          <div *ngIf="!item.validator.isValid('productId')" class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('productId')">
                              {{ error | translate }}
                            </div>
                          </div>
                        </td>

                        <td>
                          <span class="uploaded-image"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup && item.poProductDetail.productImageCount"
                            (click)="getPreviewProductImage(1,item.poProductDetail,productImage)">
                            {{ item.poProductDetail.productImageCount }} <img src="assets/images/img.png" alt="">
                          </span>

                        </td>

                        <td class="wordbreak bookingProductDescription width-180">
                          <ng-template #productDescpopContent>
                            <span>
                              {{item.poProductDetail.productDesc}}
                            </span>
                          </ng-template>
                          <p>
                            <span class="cursor-pointer" [ngbPopover]="productDescpopContent"
                              triggers="mouseenter:mouseleave" placement="auto" [autoClose]="'outside'"
                              popoverTitle="Product Description">
                              {{
                              item.poProductDetail.productDesc
                              | slice:0:50
                              }}
                            </span>
                          </p>

                        </td>

                        <td
                          *ngIf="!isReInspection && (entPageFieldAccessEnum.Booking_Edit_POQuantity | dataFieldAccessPipe :filterEntFieldAccess)">
                          <span class="highlight-badge disabled"
                            *ngIf="item.poProductDetail.poQuantity">{{item.poProductDetail.poQuantity}}</span>
                        </td>

                        <td>
                          <div class="my-input-group small width100">
                            <input [(ngModel)]="item.poProductDetail.bookingQuantity" type="number" min="1"
                              maxlength="30" (keypress)="numericValidation($event)" [disabled]="_bookingIsInspected"
                              placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_BOOKING_QTY' | translate }}"
                              (input)="ChangeBookingQty(item)"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('bookingQuantity')}"
                              oninput="validity.valid||(value='');">
                          </div>

                          <div *ngIf="!item.validator.isValid('bookingQuantity')" class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('bookingQuantity')">
                              {{ error | translate }}
                            </div>
                          </div>
                        </td>

                        <td *ngIf="bookingMasterData.isPicking" class="text-center">
                          <div class="my-input-group">

                            <div *ngIf="item.poProductDetail.pickingQuantity" class="product-count"
                              (click)=toggleExpandPicking($event,i,item)>
                              {{item.poProductDetail.pickingQuantity}}
                            </div>

                            <button *ngIf="!_bookingIsInspected && !item.poProductDetail.pickingQuantity" id="btnsearch"
                              class="secondary-cta x-small-new mr-2" style="font-size:12px;"
                              (click)="toggleExpandPicking($event,i,item)">
                              {{'EDIT_BOOKING.LBL_ADD_PICKING' | translate }}
                            </button>

                          </div>
                        </td>

                        <td>
                          <div class="my-input-group small width100">
                            <div class="calendar-wrapper small">
                              <input type="text" readonly="readonly" maxlength="10" [disabled]="_bookingIsInspected"
                                [(ngModel)]="item.poProductDetail.etd" class="width-160" maxlength="300"
                                placeholder="{{ 'EDIT_PURCHASEORDER.LBL_ETD' | translate }}" (click)="ld.toggle()"
                                container='body' ngbDatepicker #ld="ngbDatepicker">
                              <img *ngIf="item.poProductDetail.etd" src="assets/images/cta-close-grey.svg"
                                (click)="clearChildETD(item)" alt="" class="close-icon">
                              <img src="assets/images/new-set/calendar.svg" alt="" class="calendar-icon"
                                (click)="ld.toggle()">
                            </div>
                          </div>
                        </td>

                        <td>
                          <div class="my-input-group">
                            <ng-select [items]="destinationCountryList" [multiple]="false" [closeOnSelect]="true"
                              [searchable]="true" class="width-160" bindLabel="countryName" bindValue="id"
                              [loading]="initialLoading" appendTo="body" [clearable]="false"
                              [(ngModel)]="item.poProductDetail.destinationCountryID" [disabled]="_bookingIsInspected"
                              (change)="changeDestinationCountry($event,item.poProductDetail)"
                              placeholder="--- {{ 'PURCHASEORDER_SUMMARY.LBL_SELECT' | translate }} ---">
                              <ng-template ng-option-tmp let-item="item">
                                <div class="text-wrap">{{ item.countryName }}</div>
                              </ng-template>
                            </ng-select>
                          </div> <!-- country -->
                        </td>

                        <td *ngIf="model.businessLine==_businessLine.SoftLine">
                          <div class="my-input-group small width100">
                            <input [(ngModel)]="item.poProductDetail.colorCode" [disabled]="_bookingIsInspected"
                              [ngClass]="{ 'is-invalid': model.businessLine==_businessLine.SoftLine && !item.validator.isValid('colorCode')}"
                              placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_CODE' | translate }}" type="text"
                              maxlength="30">
                          </div>
                          <div
                            *ngIf="model.businessLine==_businessLine.SoftLine && !item.validator.isValid('colorCode')"
                            class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('colorCode')">
                              {{ error | translate }}
                            </div>
                          </div>
                        </td>

                        <td *ngIf="model.businessLine==_businessLine.SoftLine">
                          <div class="my-input-group small width100">
                            <input [(ngModel)]="item.poProductDetail.colorName" [disabled]="_bookingIsInspected"
                              [ngClass]="{ 'is-invalid': model.businessLine==_businessLine.SoftLine && !item.validator.isValid('colorName')}"
                              placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_NAME' | translate }}" type="text"
                              maxlength="30">
                          </div>

                          <div
                            *ngIf="model.businessLine==_businessLine.SoftLine && !item.validator.isValid('colorName')"
                            class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('colorName')">
                              {{ error | translate }}
                            </div>
                          </div>

                        </td>

                        <td *ngIf="isContainerService">
                          <div class="my-input-group">
                            <ng-select [items]="containerList" [multiple]="false" [closeOnSelect]="true"
                              [searchable]="true" class="width-180" bindLabel="name" bindValue="id"
                              [loading]="initialLoading" appendTo="body" [clearable]="false"
                              [disabled]="_bookingIsInspected"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('containerId')}"
                              [(ngModel)]="item.poProductDetail.containerId"
                              (change)="changeContainer($event,item.poProductDetail)"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('containerId')}"
                              placeholder="--- {{ 'PURCHASEORDER_SUMMARY.LBL_SELECT' | translate }} ---">
                              <ng-template ng-option-tmp let-item="item">
                                <div class="text-wrap">{{ item.name }}</div>
                              </ng-template>
                            </ng-select>
                          </div>
                          <div *ngIf="!item.validator.isValid('containerId')" class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('containerId')">
                              {{ error | translate }}
                            </div>
                          </div>

                        </td>

                        <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                                || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="bookingMasterData.bookingProductAqlList" [multiple]="false"
                              [searchable]="false" bindLabel="value" bindValue="id" appendTo="body" class="width-100"
                              [clearable]="false"
                              [disabled]="item.poProductDetail.isDisplayMaster || _bookingIsInspected"
                              (change)="changeAql($event,item)"
                              placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                              [(ngModel)]="item.poProductDetail.aql"></ng-select>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.aqlName}}</span>
                        </td>

                        <td
                          *ngIf="!isContainerService && bookingMasterData.isCustomAqlSelected &&
                              (bookingMasterData.userTypeId==userTypeEnum.InternalUser || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="bookingMasterData.customSampleTypeList" [multiple]="false"
                              [closeOnSelect]="true" bindValue="id" bindLabel="sampleType" appendTo="body"
                              class="width-80" [(ngModel)]="item.poProductDetail.sampleType"
                              [disabled]="item.poProductDetail.aql != aqlType.AQLCustom || _bookingIsInspected"
                              (change)="changeSampleType($event,item)"
                              placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                              [clearable]="false"></ng-select>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.customSampleTypeName}}</span>
                        </td>

                        <td
                          *ngIf="!isContainerService && bookingMasterData.isCustomAqlSelected &&
                              (bookingMasterData.userTypeId==userTypeEnum.InternalUser || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <input class="width-60" placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_AQL_QTY' | translate }}"
                              [disabled]="!_bookingIsInspected && item.poProductDetail.sampleType != sampleType.Other"
                              (change)="updatePrimaryProductDataToChild(item, _bookingProductFieldType.CustomSampleSize)"
                              [(ngModel)]="item.poProductDetail.aqlQuantity" type="text" maxlength="6">
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.aqlQuantity}}</span>
                        </td>

                        <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                  || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                          <div class="my-input-group small" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="bookingMasterData.bookingProductPickList" [multiple]="false"
                              [disabled]="(_bookingIsInspected || (isReInspection && !bookingMasterData.IsInternalUser) || (item.poProductDetail.isDisplayMaster))"
                              [closeOnSelect]="true" bindLabel="value" bindValue="id" appendTo="body" class="width-80"
                              placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                              (change)="changeCritical($event,item)" [(ngModel)]="item.poProductDetail.critical"
                              [clearable]="false"></ng-select>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.criticalName}}</span>
                        </td>

                        <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                          <div class="my-input-group small" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="bookingMasterData.bookingProductPickList" [multiple]="false"
                              [closeOnSelect]="true" bindLabel="value" bindValue="id"
                              [disabled]="(_bookingIsInspected || (isReInspection && !bookingMasterData.IsInternalUser) || (item.poProductDetail.isDisplayMaster))"
                              class="width-80" appendTo="body" (change)="changeMajor($event,item)"
                              placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                              [(ngModel)]="item.poProductDetail.major" [clearable]="false"></ng-select>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.majorName}}</span>
                        </td>

                        <td *ngIf="!isContainerService && (bookingMasterData.userTypeId==userTypeEnum.InternalUser
                                    || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                          <div class="my-input-group small" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="bookingMasterData.bookingProductPickList" [multiple]="false"
                              [closeOnSelect]="true" class="width-80" bindLabel="value" bindValue="id"
                              (change)="changeMinor($event,item)"
                              [disabled]="(_bookingIsInspected || (isReInspection && !bookingMasterData.IsInternalUser) || (item.poProductDetail.isDisplayMaster))"
                              appendTo="body"
                              placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                              [(ngModel)]="item.poProductDetail.minor" [clearable]="false"></ng-select>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.minorName}}</span>
                        </td>

                        <td>
                          <div class="my-input-group"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup || isContainerService">
                            <ng-select [items]="bookingMasterData.bookingProductUnitList" [multiple]="false"
                              [searchable]="false" bindLabel="name" bindValue="id" [clearable]="false"
                              [disabled]="(_bookingIsInspected || (isReInspection && !bookingMasterData.IsInternalUser))"
                              (change)="onChangeUnit($event,item)"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('unit')}" appendTo="body"
                              placeholder="--- {{ 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT' | translate }} ---"
                              [(ngModel)]="item.poProductDetail.unit" class="width-80"></ng-select>
                          </div>
                          <div
                            *ngIf="!item.validator.isValid('unit') && (item.poProductDetail.isPrimaryProductInGroup || isContainerService)"
                            class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('unit')">
                              {{ error | translate }}
                            </div>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup && !isContainerService">{{item.poProductDetail.unitName}}</span>
                        </td>

                        <td>
                          <div class="my-input-group small"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup || isContainerService">
                            <input
                              [disabled]="(_bookingIsInspected || (isReInspection && !bookingMasterData.IsInternalUser))"
                              min="1" placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_PLH_UNIT_COUNT' | translate }}"
                              (change)="onChangeUnitCount(item)" [(ngModel)]="item.poProductDetail.unitCount"
                              class="width-50" type="number">
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup && !isContainerService">{{item.poProductDetail.unitCount}}</span>
                        </td>



                        <td
                          *ngIf="(entPageFieldAccessEnum.Booking_Edit_Product_Barcode | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="my-input-group small width100"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup || isContainerService">
                            <input [(ngModel)]="item.poProductDetail.barcode" (change)="onChangeBarCode(item)"
                              placeholder="{{ 'EDIT_BOOKING.LBL_PO_PRODUCT_BARCODE' | translate }}" type="text"
                              maxlength="30">
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup && !isContainerService">{{item.poProductDetail.barcode}}</span>
                        </td>

                        <td
                          *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_Factory_Reference | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="my-input-group small" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <input class="width-100" [(ngModel)]="item.poProductDetail.factoryReference"
                              (change)="updatePrimaryProductDataToChild(item, _bookingProductFieldType.FactoryReference)"
                              placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_PLH_FACTORY_REF' | translate }}" type="text">
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.factoryReference}}</span>
                        </td>

                        <td *ngIf="!isContainerService">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="bookingMasterData.bookingProductCategoryList" [multiple]="false"
                              [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                              [clearable]="false"
                              [disabled]="item.poProductDetail.productCategoryMapped || isReInspection" [ngClass]=" { 'is-invalid' :
                                              !item.validator.isValid('productCategoryId')}" appendTo="body"
                              class="width-180" placeholder="--- {{(bookingMasterData.bookingProductCategoryList.length>0? 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT'
                                              :'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                              [(ngModel)]="item.poProductDetail.productCategoryId"
                              (change)="onChangeProductCategory($event,item)">
                            </ng-select>
                          </div>
                          <div *ngIf="!item.validator.isValid('productCategoryId')
                          && (item.poProductDetail.isPrimaryProductInGroup || isContainerService)"
                            class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('productCategoryId')">
                              {{ error | translate }}
                            </div>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.productCategoryName}}</span>
                        </td>

                        <td *ngIf="!isContainerService">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="item.poProductDetail.bookingCategorySubProductList"
                              [loading]="item.poProductDetail.productCategorySubLoading" [multiple]="false"
                              [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                              [clearable]="false"
                              [disabled]="item.poProductDetail.productSubCategoryMapped || isReInspection" [ngClass]=" { 'is-invalid' :
                                              !item.validator.isValid('productSubCategoryId')}" appendTo="body"
                              class="width-180" placeholder="--- {{(item.poProductDetail.bookingCategorySubProductList.length>0? 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT'
                                              :'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                              [(ngModel)]="item.poProductDetail.productSubCategoryId"
                              (change)="onChangeProductSubCategory($event,item)">
                            </ng-select>
                          </div>
                          <div
                            *ngIf="!item.validator.isValid('productSubCategoryId') && (item.poProductDetail.isPrimaryProductInGroup || isContainerService)"
                            class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('productSubCategoryId')">
                              {{ error | translate }}
                            </div>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.productSubCategoryName}}</span>
                        </td>

                        <td
                          *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_Product_SubCategory2 | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="item.poProductDetail.bookingCategorySub2ProductList" [multiple]="false"
                              [closeOnSelect]="true" [searchable]="true"
                              [disabled]="item.poProductDetail.productCategorySub2Mapped?true:false" bindLabel="name"
                              bindValue="id" [clearable]="false"
                              [loading]="item.poProductDetail.productCategorySub2Loading"
                              [ngClass]="{ 'is-invalid': !item.validator.isValid('productCategorySub2Id')}"
                              (change)="onChangeProductSubCategory2($event,item)" appendTo="body" class="width-180"
                              placeholder="--- {{(item.poProductDetail.bookingCategorySub2ProductList.length>0? 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT'
                                              :'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                              [(ngModel)]="item.poProductDetail.productCategorySub2Id"></ng-select>
                          </div>
                          <div
                            *ngIf="!item.validator.isValid('productCategorySub2Id') && (item.poProductDetail.isPrimaryProductInGroup || isContainerService)"
                            class="invalid-feedback">
                            <div *ngFor="let error of item.validator.getErrors('productCategorySub2Id')">
                              {{ error | translate }}
                            </div>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.productCategorySub2Name}}</span>
                        </td>

                        <td *ngIf="!isContainerService && bookingMasterData.IsInternalUser">
                          <div class="my-input-group" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <ng-select [items]="item.poProductDetail.bookingCategorySub3ProductList" [multiple]="false"
                              [closeOnSelect]="true" [searchable]="true"
                              [disabled]="item.poProductDetail.productCategorySub3Mapped?true:!bookingMasterData.IsInternalUser"
                              bindLabel="name" bindValue="id" [clearable]="false"
                              [loading]="item.poProductDetail.productCategorySub3Loading"
                              (change)="onChangeProductSubCategory3($event,item)" appendTo="body" class="width-180"
                              placeholder="--- {{(item.poProductDetail.bookingCategorySub3ProductList.length>0? 'CUSTOMER_PRODUCT_SUMMARY.LBL_SELECT'
                                              :'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                              [(ngModel)]="item.poProductDetail.productCategorySub3Id"></ng-select>
                          </div>

                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.productCategorySub3Name}}</span>
                        </td>

                        <td
                          *ngIf="(entPageFieldAccessEnum.Booking_Edit_CustomerRefPo | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="my-input-group small width100">
                            <input [(ngModel)]="item.poProductDetail.customerReferencePo" type="text"
                              placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_CUST_REF_PO' | translate }}" maxlength="30">
                          </div>
                        </td>


                        <td>
                          <div class="my-input-group small width100"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup || isContainerService">

                            <input type="text" value="12"
                              placeholder="{{ 'EDIT_BOOKING.LBL_PO_PRODUCT_REMARKS' | translate }}"
                              (change)="changeProductRemarks(item)" [(ngModel)]="item.poProductDetail.remarks">

                          </div>

                          <ng-template #productRemarksContent>
                            <span>
                              {{item.poProductDetail.remarks}}
                            </span>
                          </ng-template>
                          <p class="ml-8" *ngIf="!item.poProductDetail.isPrimaryProductInGroup && !isContainerService">
                            <span [ngbPopover]="productRemarksContent" placement="auto" [autoClose]="'outside'"
                              popoverTitle="Product Remarks">{{item.poProductDetail.remarks | slice:0:15 }}</span>
                          </p>

                        </td>


                        <td *ngIf="model.businessLine==_businessLine.SoftLine && bookingMasterData.IsInternalUser">

                          <div class="my-input-group small width100">
                            <div class="calendar-wrapper small">
                              <input type="text" readonly="readonly" maxlength="10"
                                [(ngModel)]="item.poProductDetail.asReceivedDate" class="width-100" maxlength="300"
                                placeholder="{{ 'EDIT_BOOKING.LBL_PO_PRODUCT_PLH_AS_REC' | translate }}"
                                (click)="sas.toggle()" container='body' ngbDatepicker #sas="ngbDatepicker">
                              <img src="assets/images/new-set/calendar.svg" alt="" class="calendar-icon"
                                (click)="sas.toggle()">
                            </div>
                          </div>
                        </td>

                        <td *ngIf="model.businessLine==_businessLine.SoftLine  && bookingMasterData.IsInternalUser">
                          <div class="my-input-group small width100">
                            <div class="calendar-wrapper small">
                              <input type="text" readonly="readonly" maxlength="10"
                                placeholder="{{ 'EDIT_BOOKING.LBL_PO_PRODUCT_PLH_TF_REC' | translate }}"
                                [(ngModel)]="item.poProductDetail.tfReceivedDate" class="width-100" maxlength="300"
                                (click)="stf.toggle()" container='body' ngbDatepicker #stf="ngbDatepicker">
                              <img src="assets/images/new-set/calendar.svg" alt="" class="calendar-icon"
                                (click)="stf.toggle()">
                            </div>
                          </div>
                        </td>

                        <td *ngIf="bookingMasterData.IsInternalUser">
                          <div class="my-input-group"
                            *ngIf="item.poProductDetail.isPrimaryProductInGroup || isContainerService">
                            <ng-select #fbTemplateList [items]="bookingMasterData.fbTemplateList" bindLabel="name"
                              bindValue="id" [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                              [hideSelected]="true" [(ngModel)]="item.poProductDetail.fbTemplateId" appendTo="body"
                              class="width-160" (change)="assignFBTemplate(item,$event)"
                              (clear)="clearFBTemplateList(item)"
                              placeholder="--- {{ (bookingMasterData.fbTemplateList!=null && bookingMasterData.fbTemplateList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA' ) | translate }} ---">
                              <ng-template ng-option-tmp let-item="item">
                                <div class="text-wrap">{{ item.name }}</div>
                              </ng-template>
                            </ng-select>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup && !isContainerService">{{item.poProductDetail.fbTemplateName}}</span>
                        </td>

                        <td
                          *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayChild | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="my-input-group">
                            <ng-select *ngIf="item.poProductDetail.isPrimaryProductInGroup" [closeOnSelect]="true"
                              [searchable]="true" appendTo="body" [items]="bookingMasterData.displayMasterProducts"
                              [(ngModel)]="item.poProductDetail.parentProductId" bindLabel="name" bindValue="id"
                              (change)="changeDisplayChildProduct(item,$event)" (clear)="clearDisplayChild(item)"
                              [disabled]="item.poProductDetail.isDisplayMaster" class="width-180" placeholder="--- {{(bookingMasterData.displayMasterProducts && bookingMasterData.displayMasterProducts.length>0?
                                            'COMMON.LBL_SELECT':'COMMON.LBL_NO_DATA')  | translate }} ---">
                              <ng-template ng-option-tmp let-item="item">
                                <div class="text-wrap">{{ item.name }}</div>
                              </ng-template>
                            </ng-select>
                          </div>

                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup">{{item.poProductDetail.parentProductName}}</span>
                        </td>
                        <td
                          *ngIf="!isContainerService && (entPageFieldAccessEnum.Booking_Edit_DisplayMaster | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="styled-checkbox-container" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <input class="styled-checkbox" id="checkbox-IsDisplay-{{i}}" type="checkbox" value="value1"
                              [disabled]="item.poProductDetail.parentProductId"
                              (change)="changeDisplayMasterProduct(item)"
                              [(ngModel)]="item.poProductDetail.isDisplayMaster">
                            <label for="checkbox-IsDisplay-{{i}}"></label>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup && item.poProductDetail.isDisplayMaster">{{item.poProductDetail.isDisplayMaster}}</span>
                        </td>
                        <td
                          *ngIf="!isContainerService && bookingMasterData.IsInternalUser && (entPageFieldAccessEnum.Booking_Edit_EcoPack | dataFieldAccessPipe :filterEntFieldAccess)">
                          <div class="styled-checkbox-container" *ngIf="item.poProductDetail.isPrimaryProductInGroup">
                            <input class="styled-checkbox" id="checkbox-IsEcopack-{{i}}" type="checkbox"
                              value="ecopackvalue" [(ngModel)]="item.poProductDetail.isEcopack"
                              (change)="changeEcoPack(item)">
                            <label for="checkbox-IsEcopack-{{i}}"></label>
                          </div>
                          <span class="ml-8"
                            *ngIf="!item.poProductDetail.isPrimaryProductInGroup && item.poProductDetail.isEcopack">{{item.poProductDetail.isEcopack}}</span>
                        </td>
                        <td></td>
                      </tr>

                      <ng-container *ngIf="bookingMasterData.isPicking">
                        <ng-template [ngTemplateOutlet]="pickingListTemplate"
                          [ngTemplateOutletContext]="{ item: item, i:i}">
                        </ng-template>
                      </ng-container>

                    </ng-template>

                  </tbody>
                </table>
              </div>
              <div class="mt-2" *ngIf="(bookingMasterData.bookingPOProductValidators.length>0) && !_bookingIsInspected">
                <span class="advanced-search cursor-pointer" (click)="addToBookingProducts()">
                  <img class="align-text-top" src="assets/images/new-set/plus.svg" alt=""> {{
                  'EDIT_BOOKING.LBL_NEW_POPRODUCT' | translate }}
                </span>
              </div>

              <div class="row marginTop15" *ngIf="bookingMasterData.bookingProductFiles.length>0">
                <div class="col-lg-6">
                  <div class="table-container booking-table-container mt-4 h-scroll table-max-height-400"
                    style="width: 100%;">
                    <table class="pagination-table bordered">
                      <thead>
                        <tr>
                          <th>{{ 'EDIT_BOOKING.LBL_PRODUCT_NAME' | translate }}</th>
                          <th>{{ 'EDIT_BOOKING.LBL_PRODUCT_DESC' | translate }}</th>
                          <th>{{ 'EDIT_BOOKING.LBL_PRODUCT_IMAGE' | translate }}</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of bookingMasterData.bookingProductFiles; let i=index;">
                          <td>{{item.productName}}</td>
                          <td class="wordbreak width-180">{{item.productDesc}}</td>
                          <td style="color: blue; cursor:pointer;">
                            <a (click)="getPreviewProductImage(2,item.file,productImage)">
                              {{
                              (item.fileName.length>20)? (item.fileName | slice:0:20)+'..':(item.fileName)
                              }}
                            </a>
                          </td>
                          <td>
                            <span class="table-action" (click)="removeUploadImage(i,item)">
                              <img src="assets/images/new-set/delete.svg" alt="">
                            </span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

      <div class="text-right mt-2 mb-3 pb-1">
        <button class="secondary-cta link" (click)="exportProducts()" [disabled]="exportProductLoading" *ngIf="bookingMasterData.bookingPOProductValidators && bookingMasterData.bookingPOProductValidators.length>
          0
          && model.id > 0 && bookingMasterData.IsInternalUser">
          <img class="align-bottom mr-1" src="assets/images/new-set/export.svg" alt="">{{
          'QUOTATION_SUMMARY.LBL_EXPORT' | translate
          }}
          <span *ngIf="exportProductLoading">process information</span>
        </button>
        <button class="secondary-cta big" (click)="moveToPreviousPanel()">
          {{
          'EDIT_BOOKING.LBL_PREV' | translate
          }}
        </button>
        <button class="primary-cta big ml-1" (click)="IsBookingPanelDataValid()">
          {{
          'EDIT_BOOKING.LBL_NEXT' |
          translate
          }}
        </button>
      </div>
    </div>

    <div class="step-body" *ngIf="false && stepTwo == 2">
      <div class="body-section-wrapper">
        <div class="row mt-1">
          <div class="col-lg-2">
            <div class="rect-common animate height1"></div>
          </div>
          <div class="col-lg-2">
            <div class="rect-common animate height1"></div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-2 process-information-placeholder">
            <div class="rect-common animate width20"></div>
            <div class="rect-common animate width100 ml-2"></div>
          </div>
          <div class="col-lg-2 process-information-placeholder">
            <div class="rect-common animate width20"></div>
            <div class="rect-common animate width100 ml-2"></div>
          </div>
          <div class="col-lg-2 process-information-placeholder">
            <div class="rect-common animate width20"></div>
            <div class="rect-common animate width100 ml-2"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--#endregion Process Info-->
  <!--#region Technical Documents-->

  <div class="booking-step-container"
    [ngClass]="{'active': panelNavigation.stepThree == panelNavigationStatus.Active, 'complete': panelNavigation.stepThree == panelNavigationStatus.Completed}">
    <div class="step-header step3">
      <div class="heading-container">
        <span
          *ngIf="panelNavigation.stepThree == panelNavigationStatus.Default || panelNavigation.stepThree == panelNavigationStatus.Active"
          class="step-count" [ngClass]="{'active': panelNavigation.stepThree == panelNavigationStatus.Active}">3</span>
        <img *ngIf="panelNavigation.stepThree == panelNavigationStatus.Completed"
          src="assets/images/new-set/green-circle-tick.svg" alt="">
        <h3 class="title">{{ 'EDIT_BOOKING.LBL_TECHNICAL_DOC' | translate }}</h3>

        <ng-container *ngIf="panelNavigation.stepThree == panelNavigationStatus.Completed">
          <div class="selected-values-container">
            <div class="step-selected-values">
              <small>{{ 'EDIT_BOOKING.LBL_COMMENTS_ENTITY' | translate }}</small>
              <p>{{model.apiBookingComments | slice:0:25}}</p>
            </div>
          </div>
        </ng-container>

      </div>
    </div>
    <div class="step-body" *ngIf="panelNavigation.stepThree == panelNavigationStatus.Active">
      <div class="new-structure">
        <div class="step-body-column">
          <div class="step-body-row">
            <div class="body-section-wrapper">
              <div class="technical-document-container">
                <div class="files-container">
                  <div class="file-upload-container flex-one" (click)="selectFiles(_fileAttachmentCategory.General)">
                    <img src="assets/images/new-set/upload-big.svg" class="upload-icon">
                    <div class="upload-here">
                      <h3 class="upload-title">{{ 'EDIT_BOOKING.LBL_UPLOAD_DOCUMENTS' | translate }}</h3>
                      <p class="upload-content drop-file">
                        Drop files to upload, <span>
                          {{ 'EDIT_BOOKING.LBL_UPLOAD_SELECT_FILES' | translate }}
                        </span>
                      </p>
                    </div>
                  </div>

                  <div class="file-attachment-container"
                    *ngIf="bookingMasterData.inspectionFileAttachments && bookingMasterData.inspectionFileAttachments.length>0">
                    <h6 class="files-count">
                      {{bookingMasterData.inspectionFileAttachments.length}}
                      Files uploaded
                    </h6>

                    <div class="file-attached-container">

                      <ng-container *ngFor="let file of bookingMasterData.inspectionFileAttachments; let j = index">

                        <div class="attachment">
                          <div class="cursorPointer" (click)="OpenFile(file.fileUrl)" (mouseleave)="p.close()"
                            (mouseenter)="p.open()" #p="ngbPopover" ngbPopover="{{file.fileDescription}}">
                            <img [src]="getImageIcon(file)">
                            <span class="file-name">{{file.fileName}}</span>
                          </div>
                          <img src="assets/images/new-set/close.svg" class="close-icon" (click)="removeAttachment(j)">
                        </div>



                      </ng-container>

                      <div class="attachment" *ngIf="bookingMasterData.showDownloadAllAttachment">
                        <div class="cursorPointer" (click)="getBookingZipFileAttachment()">
                          <span class="file-name" style="color: red">
                            <u>
                              {{
                              'EDIT_BOOKING.LBL_DOWNLOAD_ALL_ATTACH' |
                              translate
                              }}
                            </u>
                          </span>
                        </div>
                      </div>

                    </div>

                  </div>

                  <ng-container *ngIf="(bookingMasterData.userTypeId==userTypeEnum.InternalUser
                  || bookingMasterData.userTypeId==userTypeEnum.Customer)">
                    <table class="pagination-table bordered"
                      *ngIf="bookingMasterData.inspectionFileAttachments != null && bookingMasterData.inspectionFileAttachments.length>0">
                      <thead>
                        <tr>

                          <th>{{ 'EDIT_BOOKING.LBL_TECH_FILE_NAME' | translate }}</th>
                          <th>{{ 'EDIT_BOOKING.LBL_TECH_FILE_DESC' | translate }}</th>
                          <th class="Center_Middle" style="width:180px"
                            [attr.data-tooltip]="_bookingAttachmentConfirmForEmail"
                            class="text-tooltip-table Center_Middle">
                            {{ 'EDIT_BOOKING.LBL_TECH_FILE_BOOKING_EMAIL' | translate }}

                            <span><img src="assets/images/new-set/info-white.svg" alt=""></span>

                          </th>

                          <th [attr.data-tooltip]="_bookingAttachmentConfirmForReport" style="width:180px"
                            class="text-tooltip-table Center_Middle"
                            *ngIf="bookingMasterData.userTypeId==userTypeEnum.InternalUser">
                            {{ 'EDIT_BOOKING.LBL_TECH_FILE_REPORT' | translate }}
                            <span>
                              <img src="assets/images/new-set/info-white.svg" alt="">
                            </span>

                          </th>


                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of bookingMasterData.inspectionFileAttachments;let idx = index">

                          <td class="width-120 wordbreak"> {{item.fileName}}</td>
                          <td>{{item.fileDescription}}</td>

                          <td class="width-60 Center_Middle">
                            <div class="styled-checkbox-container">
                              <input class="styled-checkbox" id="checkbox-bookingEmail-{{idx}}" type="checkbox"
                                [(ngModel)]="item.isBookingEmailNotification">
                              <label for="checkbox-bookingEmail-{{idx}}"></label>
                            </div>
                          </td>

                          <td class="width-60 Center_Middle"
                            *ngIf="bookingMasterData.userTypeId==userTypeEnum.InternalUser">
                            <div class="styled-checkbox-container">
                              <input class="styled-checkbox" id="checkbox-fbReport-{{idx}}" type="checkbox"
                                [(ngModel)]="item.isReportSendToFB">
                              <label for="checkbox-fbReport-{{idx}}"></label>
                            </div>
                          </td>

                        </tr>
                      </tbody>
                    </table>
                  </ng-container>





                </div>

                <div class="document-input-container">
                  <div class="comment-container">
                    <div class="my-input-group">
                      <label for="">{{ 'EDIT_BOOKING.LBL_COMMENTS_ENTITY' | translate }}</label>
                      <textarea maxlength="4000" [disabled]="!bookingMasterData.IsInternalUser"
                        placeholder="{{ 'EDIT_BOOKING.LBL_COMMENTS_ENTITY' | translate }}"
                        [(ngModel)]="model.apiBookingComments" type="text"></textarea>
                    </div>
                  </div>
                  <div class="comment-container mt-2 mt-sm-0">
                    <div class="my-input-group">
                      <label for="">{{ 'EDIT_BOOKING.LBL_CUSTOMER_BOOKING_COMMENTS' | translate }}</label>
                      <textarea [disabled]="bookingMasterData.IsInternalUser" maxlength="4000"
                        placeholder="{{ 'EDIT_BOOKING.LBL_CUSTOMER_BOOKING_COMMENTS' | translate }}"
                        [(ngModel)]="model.cusBookingComments" type="text"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="text-right mt-2 mb-3 pb-1">
        <button class="secondary-cta big" (click)="moveToPreviousPanel()">
          {{
          'EDIT_BOOKING.LBL_PREV' | translate
          }}
        </button>
        <button *ngIf="!bookingMasterData.IsInternalUser" class="primary-cta big ml-1" (click)="bookingPreview()">
          {{
          'EDIT_BOOKING.LBL_PREVIEW' |
          translate
          }}
        </button>
        <button class="primary-cta big ml-1" (click)="moveToNextPanel()" *ngIf="bookingMasterData.IsInternalUser">
          {{
          'EDIT_BOOKING.LBL_NEXT' |
          translate
          }}
        </button>
      </div>
    </div>

    <div class="step-body" *ngIf="false">
      <div class="body-section-wrapper">
        <div class="row mt-1">
          <div class="col-lg-5">
            <div class="rect-common animate height84"></div>
          </div>
          <div class="col-lg-3">
            <div class="rect-common animate height84"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- #endregion Techincal Documents-->
  <!--#region Internal Reference-->

  <div class="booking-step-container" *ngIf="bookingMasterData.IsInternalUser"
    [ngClass]="{'active': panelNavigation.stepFour == panelNavigationStatus.Active, 'complete': panelNavigation.stepFour == panelNavigationStatus.Completed}">
    <div class="step-header step4">
      <div class="heading-container">
        <span
          *ngIf="panelNavigation.stepFour == panelNavigationStatus.Default || panelNavigation.stepFour == panelNavigationStatus.Active"
          class="step-count" [ngClass]="{'active': panelNavigation.stepFour == panelNavigationStatus.Active}">4</span>
        <img *ngIf="panelNavigation.stepFour == panelNavigationStatus.Completed"
          src="assets/images/new-set/green-circle-tick.svg" alt="">
        <h3 class="title">{{ 'EDIT_BOOKING.LBL_MAIN_DETAILS' | translate }}</h3>
      </div>
    </div>
    <div class="step-body" *ngIf="panelNavigation.stepFour == panelNavigationStatus.Active">
      <div class="new-structure">
        <div class="step-body-column">
          <div class="step-body-row">
            <div class="body-section-wrapper">
              <div class="row">
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_OFFICE' | translate }}</label>
                    <ng-select #customer [multiple]="false" [closeOnSelect]="true" [searchable]="true" appendTo="body"
                      [disabled]="(isReInspection && !bookingMasterData.IsInternalUser)"
                      [loading]="bookingMasterData.Initialloading" [items]="bookingMasterData.Office" bindLabel="name"
                      bindValue="id" [ngClass]="{ 'is-invalid': !validator.isValid('officeId')}" [hideSelected]="true"
                      (change)="getOfficeRelatedDetails($event)"
                      placeholder="--- {{(bookingMasterData.Office!=null && bookingMasterData.Office.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                      [(ngModel)]="model.officeId" [clearable]="false">
                    </ng-select>
                    <div *ngIf="!validator.isValid('officeId')" class="invalid-feedback" style="display:block">
                      <div *ngFor="let error of validator.getErrors('officeId')">{{ error | translate }}</div>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{ 'EDIT_BOOKING.LBL_COMPASS_BOOKING_NO' | translate }}</label>
                    <input type="text" [disabled]="!bookingMasterData.IsInternalUser" maxlength="1500"
                      placeholder="{{ 'EDIT_BOOKING.LBL_COMPASS_BOOKING_NO' | translate }}"
                      [(ngModel)]="model.compassBookingNo" />
                  </div>
                </div>
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="my-input-group">
                    <label for="">{{'BOOKING_SUMMARY.LBL_AE' | translate}}</label>
                    <ng-select #customer [multiple]="true" class="multiple" [closeOnSelect]="true" [searchable]="true"
                      appendTo="body" [loading]="bookingMasterData.Initialloading" [items]="bookingMasterData.csList"
                      bindLabel="name" bindValue="id" [hideSelected]="true"
                      placeholder="--- {{(bookingMasterData.csList!=null && bookingMasterData.csList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                      [(ngModel)]="model.csList" [clearable]="false">
                    </ng-select>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="comment-container">
                    <div class="my-input-group">
                      <label for="">{{ 'EDIT_BOOKING.LBL_INTERNAL_COMMENTS' | translate }}</label>
                      <textarea [disabled]="(isReInspection && !bookingMasterData.IsInternalUser)" maxlength="4000"
                        placeholder="{{ 'EDIT_BOOKING.LBL_INTERNAL_COMMENTS' | translate }}"
                        [(ngModel)]="model.internalComments"></textarea>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="comment-container">
                    <div class="my-input-group">
                      <label for="">{{ 'EDIT_BOOKING.LBL_QC_COMMENT' | translate }}</label>
                      <textarea [disabled]="(isReInspection && !bookingMasterData.IsInternalUser)" maxlength="4500"
                        placeholder="{{ 'EDIT_BOOKING.LBL_QC_COMMENT' | translate }}"
                        [(ngModel)]="model.qcBookingComments"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="step-body-row" *ngIf="false">
            <div class="body-section-wrapper">
              <div class="row">
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="comment-container">
                    <div class="my-input-group">
                      <label for="">Customer booking comment</label>
                      <textarea name="" id="" placeholder="sample text"></textarea>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-6 col-lg-6 col-xl-3 mt-2">
                  <div class="comment-container">
                    <div class="my-input-group">
                      <label for="">Internal team comment</label>
                      <textarea name="" id="" placeholder="sample text"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="text-right mt-2 mb-3 pb-1">
        <button class="secondary-cta big" (click)="moveToPreviousPanel()">
          {{
          'EDIT_BOOKING.LBL_PREV' | translate
          }}
        </button>
        <button class="primary-cta big ml-1" (click)="bookingPreview()">
          {{
          'EDIT_BOOKING.LBL_PREVIEW' |
          translate
          }}
        </button>
      </div>
    </div>

    <div class="step-body" *ngIf="false">
      <div class="body-section-wrapper">
        <div class="row mt-1">
          <div class="col-lg-3 pr-lg-0">
            <div class="rect-common animate height36"></div>
          </div>
          <div class="col-lg-3">
            <div class="rect-common animate height36"></div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-3 pr-lg-0">
            <div class="rect-common animate height66"></div>
          </div>
          <div class="col-lg-3">
            <div class="rect-common animate height66"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--#endregion Internal Reference-->
  <!--#endregion Booking Body Section -->


</ng-template>

<!-- <ng-template #addNewPoTemplate let-modal>

  <div class="delete-popup-container">
    <div class="content">
      <img src="assets/images/caution-red.svg" alt="">
      <div class="title-container">
        <h3>{{ 'EDIT_BOOKING.LBL_ADD_NEW_PO_TITLE' | translate }}</h3>
        <p>{{ 'EDIT_BOOKING.LBL_ADD_NEW_PO_CHECK' | translate }} <b>{{this.bookingMasterData.selectedPoNotAvailableName }}</b></p>
      </div>
    </div>
    <div class="text-right">
      <button class="secondary-cta link" (click)="closeAddNewPo()">{{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_CANCEL' | translate }}</button>
      <button class="primary-cta" (click)="savePurchaseOrderDataModel();">{{ 'EDIT_BOOKING.LBL_DELETE_PO_POPUP_OK' | translate }}</button>
    </div>
  </div>

</ng-template> -->

<ng-template #addNewPoTemplate let-modal>
  <div class="modal-body">
    <div class="small-model">

      <h2 class="title">{{ 'EDIT_BOOKING.LBL_ADD_NEW_PO_TITLE' | translate }}</h2>

      <p>
        {{ 'EDIT_BOOKING.LBL_ADD_NEW_PO_CHECK' | translate }} <b>
          {{
          this.bookingMasterData.selectedPoNotAvailableName
          }}
        </b>
      </p>

      <button class="secondary-cta" (click)="closeAddNewPo()">
        {{
        'COMMON.LBL_CONFIRMCANCEL' | translate
        }}
      </button>

      <button class="primary-cta" (click)="savePurchaseOrderDataModel();">
        {{ 'COMMON.LBL_OK' | translate }}
      </button>

    </div>
  </div>

</ng-template>



<div class="loader-overlay" *ngIf="bookingMasterData.pageLoader">
  <div class="loader-container">
    <img src="assets/images/reload.svg" alt="">
    <span>{{'COMMON.LBL_LOADER' | translate}}</span>
  </div>
</div>

<ng-template #pickingListTemplate let-item="item" let-i="i">
  <tr class="expandable-row" style="border-bottom: 2px solid #f4f6f8;" [attr.data-expand-id]="'picking' + i">
    <td
      *ngIf="item.poProductDetail.togglePicking && item.poProductDetail.inspectionPickingValidators && item.poProductDetail.inspectionPickingValidators.length>0">
    </td>
    <td colspan="9" *ngIf="item.poProductDetail.isPlaceHolderVisible">
      <div class="table-container child-table h-scroll table-max-height-450">
        <table class="pagination-table simple-table bordered">

          <thead>
            <tr class="sticky-top-row">
              <th *ngIf="!_bookingIsInspected"></th>
              <th>{{'EDIT_BOOKING.LBL_LAB_CUSTOMER' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_CUSTOMER_ADDRESS' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_CUSTOMER_CONTACTS' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_PICKING_QTY' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_REMARKS' | translate}}</th>
            </tr>
          </thead>

          <tbody>

            <ng-template ngFor let-pickingItem [ngForOf]="item.poProductDetail.inspectionPickingValidators"
              let-i="index">
              <tr>

                <td *ngIf="!_bookingIsInspected">
                  <span class="table-cta icon-cta common-tooltip" (click)="removeInspectionPickingList(item,i)"
                    data-tooltip="Delete">
                    <img src="assets/images/new-set/delete.svg" alt="Delete">
                  </span>
                </td>

                <td>
                  <ng-select class="width-180" [searchable]="true" [items]="inspectionPickingMaster.labOrCustomerList"
                    bindLabel="name" [clearable]="false" bindValue="id" [hideSelected]="true"
                    (change)="getLabRelatedDetails($event,pickingItem)"
                    placeholder="--- {{(inspectionPickingMaster.labOrCustomerList!=null && inspectionPickingMaster.labOrCustomerList.length!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                    [(ngModel)]="pickingItem.pickingData.labOrCustomerId" appendTo="body">
                    <ng-template ng-option-tmp let-item="item">
                      <div class="text-wrap">{{ item.name }}</div>
                    </ng-template>
                  </ng-select>
                </td>

                <td>

                  <div>
                    <a *ngIf="pickingItem.pickingData.labOrCustomerId>0 && !_bookingIsInspected"
                      (click)="addNewLabAddressPopup(pickingItem,LabAddressTemplate)" class="tdright-link">
                      +Address
                    </a>
                  </div>

                  <ng-select class="width-260" [searchable]="true"
                    [items]="pickingItem.pickingData.labOrCustomerAddressList" bindLabel="name" [clearable]="false"
                    bindValue="id" [hideSelected]="true" (change)="changeLabAddress($event,pickingItem)"
                    [ngClass]="{ 'is-invalid': pickingItem.pickingData.labOrCustomerId>0?!pickingItem.validator.isValid('labOrCustomerAddressId'):false}"
                    placeholder="--- {{(pickingItem.pickingData.labOrCustomerAddressList!=null && pickingItem.pickingData.labOrCustomerAddressList!=0? 'EDIT_BOOKING.LBL_SELECT':'EDIT_BOOKING.MSG_NO_DATA')  | translate }} ---"
                    [(ngModel)]="pickingItem.pickingData.labOrCustomerAddressId" appendTo="body">
                    <ng-template ng-option-tmp let-item="item">
                      <div class="text-wrap">{{ item.name }}</div>
                    </ng-template>
                  </ng-select>
                  <div
                    *ngIf="(pickingItem.pickingData.labOrCustomerId>0 || pickingItem.pickingData.labOrCustomerId==-1)?!pickingItem.validator.isValid('labOrCustomerAddressId'):false"
                    class="invalid-feedback">
                    <div *ngFor="let error of pickingItem.validator.getErrors('labOrCustomerAddressId')">
                      {{ error | translate }}
                    </div>
                  </div>

                </td>

                <td>

                  <ng-select [items]="pickingItem.pickingData.labOrCustomerContactList" [multiple]="true"
                    [closeOnSelect]="true" [searchable]="true" bindLabel="name" class="width-220 multiple"
                    appendTo="body" bindValue="id" (change)="changeLabContact(pickingItem)"
                    placeholder="--- {{ 'BOOKING_INSPECTIONPICKING.PH_SELECT' | translate }} ---"
                    [(ngModel)]="pickingItem.pickingData.labOrCustomerContactIds">
                    <ng-template ng-option-tmp let-item="item">
                      <div class="width-220 text-wrap">{{ item.name }}</div>
                    </ng-template>
                  </ng-select>

                  <div
                    *ngIf="(pickingItem.pickingData.labOrCustomerId>0 || pickingItem.pickingData.labOrCustomerId==-1)?!pickingItem.validator.isValid('labOrCustomerContactIds'):false"
                    class="invalid-feedback">
                    <div *ngFor="let error of pickingItem.validator.getErrors('labOrCustomerContactIds')">
                      {{ error | translate }}
                    </div>
                  </div>

                </td>

                <td>

                  <input class="width-120" type="number" [(ngModel)]="pickingItem.pickingData.pickingQuantity"
                    (keypress)="numericValidation($event)" (input)="CalculateTotalPickingQuantity()"
                    [ngClass]="{ 'is-invalid': !pickingItem.validator.isValid('pickingQuantity')}"
                    placeholder="{{'EDIT_BOOKING.LBL_PO_PRODUCT_PICKING_QTY' | translate }}" min="1"
                    oninput="validity.valid||(value='');">
                  <div *ngIf="!pickingItem.validator.isValid('pickingQuantity')" class="invalid-feedback">
                    <div *ngFor="let error of pickingItem.validator.getErrors('pickingQuantity')">
                      {{ error | translate }}
                    </div>
                  </div>
                </td>

                <td>
                  <input type="text" placeholder="Remarks"
                    [ngClass]="{ 'is-invalid': !pickingItem.pickingData.labOrCustomerId?!pickingItem.validator.isValid('remarks'):false}"
                    [(ngModel)]="pickingItem.pickingData.remarks" class="width-180" />

                  <div *ngIf="!pickingItem.pickingData.labOrCustomerId?!pickingItem.validator.isValid('remarks'):false"
                    class="invalid-feedback">
                    <div *ngFor="let error of pickingItem.validator.getErrors('remarks')">
                      {{ error | translate }}
                    </div>
                  </div>

                </td>

              </tr>

            </ng-template>

          </tbody>

        </table>

        <div class="mt-2" *ngIf="!_bookingIsInspected">
          <span class="advanced-search cursor-pointer" (click)="addInspectionPickingList(item)">
            <img class="align-text-top" src="assets/images/new-set/plus.svg" alt=""> Add Picking
          </span>
        </div>

      </div>
    </td>
    <td class="hide-extra-td"
      *ngIf="item.poProductDetail.togglePicking && item.poProductDetail.inspectionPickingValidators && item.poProductDetail.inspectionPickingValidators.length>0">

    </td>
  </tr>
</ng-template>

<ng-template #pickingListPreviewTemplate let-item="item" let-i="i">
  <tr class="expandable-row" [attr.data-expand-id]="'pickingPreview' + i">
    <td colspan="14" *ngIf="item.poProductDetail.isPlaceHolderVisible">
      <div class="table-container child-table">
        <table class="pagination-table simple-table bordered">

          <thead>
            <tr class="sticky-top-row">
              <th>{{'EDIT_BOOKING.LBL_LAB_CUSTOMER' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_CUSTOMER_ADDRESS' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_CUSTOMER_CONTACTS' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_PICKING_QTY' | translate}}</th>
              <th>{{'EDIT_BOOKING.LBL_LAB_REMARKS' | translate}}</th>
            </tr>
          </thead>

          <tbody>

            <ng-template ngFor let-pickingItem [ngForOf]="item.poProductDetail.inspectionPickingValidators"
              let-i="index">
              <tr>
                <td class="width-120 text-wrap">
                  {{pickingItem.pickingData.labOrCustomerName}}
                </td>

                <td class="width-180 text-wrap">
                  {{pickingItem.pickingData.labOrCustomerAddressName}}
                </td>

                <td class="width-120 text-wrap">
                  {{pickingItem.pickingData.labOrCustomerContactName}}
                </td>

                <td class="width-120 text-wrap">
                  {{pickingItem.pickingData.pickingQuantity}}
                </td>

                <td class="width-120 text-wrap">
                  {{pickingItem.pickingData.remarks}}
                </td>
              </tr>

            </ng-template>

          </tbody>

        </table>

      </div>
    </td>
  </tr>
</ng-template>

<ng-template #LabAddressTemplate let-modal>


  <div class="common-popup-container">
    <img src="assets/images/black-close.svg" alt="" class="close" (click)="modal.dismiss('Cross click')">

    <h3 class="title">
      <span>
        {{'EDIT_BOOKING.LBL_ADD_LAB_ADDRESS' | translate}}
      </span>
    </h3>

    <!--<p class="subtitle" style="padding-left:0.5%">
      <span>
        Lab Name
      </span>
    </p>-->

    <div class="table-container booking-table-container mt-4 h-scroll table-max-height-400">
      <table class="pagination-table bordered">
        <thead>
          <tr>

            <th> {{'EDIT_BOOKING.LBL_ADDRESS' | translate}}</th>
            <th>{{'EDIT_BOOKING.LBL_REG_ADDRESS' | translate}}</th>
            <th>{{'EDIT_BOOKING.LBL_ZIPCODE' | translate}}</th>
            <th>{{'EDIT_BOOKING.LBL_COUNTRY' | translate}}</th>
            <th>{{'EDIT_BOOKING.LBL_PROVINCE' | translate}}</th>
            <th>{{'EDIT_BOOKING.LBL_CITY' | translate}}</th>
            <th></th>

          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of masterLabAddressData.labAddressValidators;  let i = index">

            <td>
              <div class="my-input-group">
                <textarea class="width-180" [(ngModel)]="item.addressData.way"
                  [ngClass]="{ 'is-invalid':!item.masterLabAddressValidator.isValid('way')}" maxlength="1500"
                  placeholder="{{ 'EDIT_LAB.LBL_ADDRESS' | translate }}"></textarea>

                <div *ngIf="!item.masterLabAddressValidator.isValid('way')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterLabAddressValidator.getErrors('way')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>

            <td>
              <div class="my-input-group">
                <textarea class="width-180" [(ngModel)]="item.addressData.localLanguage" maxlength="1500"
                  placeholder="{{ 'EDIT_LAB.LBL_LOCALLANGUAGEADR' | translate }}"></textarea>
                <!-- <div *ngIf="!item.masterLabAddressValidator.isValid('localLanguage')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterLabAddressValidator.getErrors('localLanguage')">
                    {{ error | translate }}
                  </div>
                </div> -->
              </div>
            </td>

            <td>
              <div class="my-input-group">
                <input type="text" class="width-120" [(ngModel)]="item.addressData.zipCode"
                  [ngClass]="{ 'is-invalid':!item.masterLabAddressValidator.isValid('zipCode')}" placeholder="Zipcode">

                <div *ngIf="!item.masterLabAddressValidator.isValid('zipCode')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterLabAddressValidator.getErrors('zipCode')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>

            <td>
              <div class="my-input-group">

                <ng-select appendTo="body" class="width-180"
                  [ngClass]="{ 'is-invalid':!item.masterLabAddressValidator.isValid('countryId')}"
                  (ngModelChange)="refreshRegions($event, item.addressData)" [items]="destinationCountryList"
                  [multiple]="false" [closeOnSelect]="true" [searchable]="true" bindLabel="countryName" bindValue="id"
                  placeholder="--- {{ 'EDIT_LAB.LBL_SELECT' | translate }} ---"
                  [(ngModel)]="item.addressData.countryId">
                </ng-select>

                <div *ngIf="!item.masterLabAddressValidator.isValid('countryId')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterLabAddressValidator.getErrors('countryId')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>


            <td>
              <div class="my-input-group">

                <ng-select appendTo="body" class="width-180"
                  [ngClass]="{ 'is-invalid':!item.masterLabAddressValidator.isValid('regionId')}"
                  (ngModelChange)="refreshCities($event, item.addressData)" [items]="item.addressData.regionList"
                  [multiple]="false" [closeOnSelect]="true" [searchable]="true" bindLabel="name" bindValue="id"
                  [loading]="" placeholder="--- {{ 'EDIT_LAB.LBL_SELECT' | translate }} ---"
                  [(ngModel)]="item.addressData.regionId">
                </ng-select>

                <div *ngIf="!item.masterLabAddressValidator.isValid('regionId')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterLabAddressValidator.getErrors('regionId')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>

            <td>
              <div class="my-input-group">

                <ng-select appendTo="body" class="width-180"
                  [ngClass]="{ 'is-invalid':!item.masterLabAddressValidator.isValid('cityId')}"
                  [items]="item.addressData.cityList" [multiple]="false" [closeOnSelect]="true" [searchable]="true"
                  bindLabel="name" bindValue="id" [loading]=""
                  placeholder="--- {{ 'EDIT_LAB.LBL_SELECT' | translate }} ---" [(ngModel)]="item.addressData.cityId">
                </ng-select>

                <div *ngIf="!item.masterLabAddressValidator.isValid('cityId')" class="invalid-feedback"
                  style="display:block">
                  <div *ngFor="let error of item.masterLabAddressValidator.getErrors('cityId')">
                    {{ error | translate }}
                  </div>
                </div>
              </div>
            </td>


            <td>
              <div class="my-input-group">
                <button class="secondary-cta small" (click)="removeMasterLabAddressRow(i)">
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-2">
      <span class="advanced-search cursor-pointer" (click)="addlabAddressRow()">
        {{
        'EDIT_BOOKING.LBL_PO_POPUP_PO_NEW' | translate
        }}
      </span>
    </div>

    <div class="cta-container">
      <button class="secondary-cta link cancel" (click)="modal.dismiss('Cross click')"
        [disabled]="bookingMasterData.pageLoader">
        {{ 'EDIT_BOOKING.LBL_PO_POPUP_CANCEL' | translate }}
      </button>
      <button class="primary-cta" (click)="saveMasterLabAddressData()" [disabled]="bookingMasterData.pageLoader">
        {{ 'EDIT_BOOKING.LBL_PO_POPUP_SAVE' | translate }}
        <span *ngIf="bookingMasterData.pageLoader">
          <i class="fa fa-refresh fa-spin" aria-hidden="true"></i>
        </span>
      </button>
    </div>
  </div>





</ng-template>
